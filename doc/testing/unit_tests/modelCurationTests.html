<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of modelCurationTests</title>
  <meta name="keywords" content="modelCurationTests">
  <meta name="description" content="run this test case with the command">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">testing</a> &gt; <a href="index.html">unit_tests</a> &gt; modelCurationTests.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for testing\unit_tests&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>modelCurationTests
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>run this test case with the command</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function tests = modelCurationTests </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">run this test case with the command
results = runtests('modelCurationTests.m')</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function addExchangeRxnsTest(testCase)</a></li><li><a href="#_sub2" class="code">function addTransportTest(testCase)</a></li><li><a href="#_sub3" class="code">function addGenesRavenTest(testCase)</a></li><li><a href="#_sub4" class="code">function removeGenesTest(testCase)</a></li><li><a href="#_sub5" class="code">function addMetsTest(testCase)</a></li><li><a href="#_sub6" class="code">function addMets_oneCompTest(testCase)</a></li><li><a href="#_sub7" class="code">function removeMetsTest(testCase)</a></li><li><a href="#_sub8" class="code">function addRxnsTest(testCase)</a></li><li><a href="#_sub9" class="code">function removeReactionsTest(testCase)</a></li><li><a href="#_sub10" class="code">function getMetsInCompTest(testCase)</a></li><li><a href="#_sub11" class="code">function getRxnsInCompTest(testCase)</a></li><li><a href="#_sub12" class="code">function getAllRxnsFromGenesTest(testCase)</a></li><li><a href="#_sub13" class="code">function changeRxnsTest(testCase)</a></li><li><a href="#_sub14" class="code">function removeBadRxnsTest(testCase)</a></li><li><a href="#_sub15" class="code">function changeGrRulesTest(testCase)</a></li><li><a href="#_sub16" class="code">function copyToCompsTest(testCase)</a></li><li><a href="#_sub17" class="code">function setExchangeBoundsTest(testCase)</a></li><li><a href="#_sub18" class="code">function addRxnsGenesMetsTest(testCase)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%run this test case with the command</span>
0002 <span class="comment">%results = runtests('modelCurationTests.m')</span>
0003 <a name="_sub0" href="#_subfunctions" class="code">function tests = modelCurationTests</a>
0004 tests = functiontests(localfunctions);
0005 <span class="keyword">end</span>
0006 
0007 <a name="_sub1" href="#_subfunctions" class="code">function addExchangeRxnsTest(testCase)</a>
0008 sourceDir = fileparts(which(mfilename));
0009 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0010 
0011 modelNew=addExchangeRxns(model,<span class="string">'both'</span>,<span class="string">'6pgl_c'</span>);
0012 
0013 <span class="comment">%Perform the curation manually for comparison</span>
0014 modelManual=model;
0015 modelManual.rxns(end+1)={<span class="string">'EXC_BOTH_6pgl_c'</span>};
0016 modelManual.lb(end+1)=-1000;
0017 modelManual.ub(end+1)=1000;
0018 modelManual.c(end+1)=0;
0019 modelManual.rev(end+1)=1;
0020 modelManual.rxnNames(end+1)={<span class="string">'6-phospho-D-glucono-1,5-lactone exchange (BOTH)'</span>};
0021 modelManual.grRules(end+1)={<span class="string">''</span>};
0022 modelManual.eccodes(end+1)={<span class="string">''</span>};
0023 modelManual.rxnGeneMat(end+1,:)=sparse(zeros(1,numel(modelManual.genes)));
0024 modelManual.S(:,end+1)=sparse(zeros(numel(modelManual.mets),1));
0025 modelManual.S(5,end)=-1;
0026 
0027 verifyEqual(testCase,modelNew,modelManual)
0028 <span class="keyword">end</span>
0029 
0030 <a name="_sub2" href="#_subfunctions" class="code">function addTransportTest(testCase)</a>
0031 sourceDir = fileparts(which(mfilename));
0032 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0033 
0034 evalc(<span class="string">'modelNew=addTransport(model,''c'',''e'',{''6-phospho-D-glucono-1,5-lactone''},false,false,''test_'');'</span>);
0035 
0036 <span class="comment">%Perform the curation manually for comparison</span>
0037 modelManual=model;
0038 modelManual.rxns(end+1)={<span class="string">'test_0001'</span>};
0039 modelManual.lb(end+1)=0;
0040 modelManual.ub(end+1)=Inf;
0041 modelManual.c(end+1)=0;
0042 modelManual.rev(end+1)=0;
0043 modelManual.rxnNames(end+1)={<span class="string">'6-phospho-D-glucono-1,5-lactone transport, Cytoplasm-Extraorganism'</span>};
0044 modelManual.grRules(end+1)={<span class="string">''</span>};
0045 modelManual.eccodes(end+1)={<span class="string">''</span>};
0046 modelManual.rxnGeneMat(end+1,:)=sparse(zeros(1,numel(modelManual.genes)));
0047 
0048 modelManual.S(:,end+1)=sparse(zeros(numel(modelManual.mets),1));
0049 modelManual.S(end+1,:)=sparse(zeros(1,numel(modelManual.rxns)));
0050 modelManual.S([5,73],end)=[-1,1];
0051 
0052 modelManual.mets(end+1)={<span class="string">'m_0001'</span>};
0053 modelManual.metNames(end+1)={<span class="string">'6-phospho-D-glucono-1,5-lactone'</span>};
0054 modelManual.metMiriams(end+1)=modelManual.metMiriams(5);
0055 modelManual.b(end+1)=[0];
0056 modelManual.metFormulas(end+1)={<span class="string">'C6H9O9P'</span>};
0057 modelManual.metComps(end+1)=[2];
0058 
0059 verifyEqual(testCase,modelNew,modelManual)
0060 <span class="keyword">end</span>
0061 
0062 <a name="_sub3" href="#_subfunctions" class="code">function addGenesRavenTest(testCase)</a>
0063 sourceDir = fileparts(which(mfilename));
0064 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0065 
0066 genesToAdd.genes={<span class="string">'testgene1'</span>,<span class="string">'testgene2'</span>};
0067 genesToAdd.geneShortNames={<span class="string">'short1'</span>,<span class="string">'short2'</span>};
0068 genesToAdd.geneMiriams{1}=struct(<span class="string">'name'</span>,{{<span class="string">'testDB1'</span>;<span class="string">'testDB2'</span>}},<span class="string">'value'</span>,<span class="keyword">...</span>
0069     {{<span class="string">'testValue1'</span>;<span class="string">'testValue2'</span>}});
0070 genesToAdd.geneMiriams{2}=struct(<span class="string">'name'</span>,{{<span class="string">'testDB2'</span>;<span class="string">'testDB1'</span>}},<span class="string">'value'</span>,<span class="keyword">...</span>
0071     {{<span class="string">'testValue2'</span>;<span class="string">'testValue1'</span>}});
0072 
0073 modelNew=addGenesRaven(model,genesToAdd);
0074 
0075 <span class="comment">%Perform the curation manually for comparison</span>
0076 modelManual=model;
0077 modelManual.geneMiriams(1:numel(modelManual.genes),1)={[]};
0078 modelManual.genes(end+1:end+2)=genesToAdd.genes;
0079 modelManual.geneShortNames(end+1:end+2)=genesToAdd.geneShortNames;
0080 modelManual.rxnGeneMat(:,end+1:end+2)=sparse(zeros(numel(modelManual.rxns),2));
0081 modelManual.geneMiriams(end+1:end+2)=genesToAdd.geneMiriams;
0082 verifyEqual(testCase,modelNew,modelManual)
0083 <span class="keyword">end</span>
0084 
0085 <a name="_sub4" href="#_subfunctions" class="code">function removeGenesTest(testCase)</a>
0086 sourceDir = fileparts(which(mfilename));
0087 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0088 
0089 modelNew=removeGenes(model,<span class="string">'b1817'</span>,true,true,false);
0090 
0091 <span class="comment">%Perform the curation manually for comparison</span>
0092 modelManual=model;
0093 modelManual.genes(54)=[];
0094 modelManual.geneShortNames(54)=[];
0095 modelManual.rxnGeneMat(:,54)=[];
0096 modelManual.rxnGeneMat(45,:)=[];
0097 modelManual.grRules(50)={<span class="string">'(b2415 and b1621 and b2417 and b2416) or (b2415 and b2417 and b2416 and b1101)'</span>};
0098 modelManual.grRules(45)=[];
0099 modelManual.rxns(45)=[];
0100 modelManual.rxnNames(45)=[];
0101 modelManual.lb(45)=[];
0102 modelManual.ub(45)=[];
0103 modelManual.c(45)=[];
0104 modelManual.rev(45)=[];
0105 modelManual.S(:,45)=[];
0106 modelManual.eccodes(45)=[];
0107 verifyEqual(testCase,modelNew,modelManual)
0108 <span class="keyword">end</span>
0109 
0110 <a name="_sub5" href="#_subfunctions" class="code">function addMetsTest(testCase)</a>
0111 sourceDir = fileparts(which(mfilename));
0112 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0113 
0114 metsToAdd.metNames={<span class="string">'metaboliteName'</span>,<span class="string">'3-Phospho-D-glycerate'</span>};
0115 metsToAdd.compartments={<span class="string">'c'</span>,<span class="string">'e'</span>};
0116 metsToAdd.metCharges=[2,0];
0117 metsToAdd.metNotes={<span class="string">'this is just a test'</span>,<span class="string">'another one'</span>};
0118 metsToAdd.metMiriams{1}=struct(<span class="string">'name'</span>,{{<span class="string">'testDB1'</span>;<span class="string">'testDB2'</span>}},<span class="string">'value'</span>,<span class="keyword">...</span>
0119     {{<span class="string">'testValue1'</span>;<span class="string">'testValue2'</span>}});
0120 metsToAdd.metMiriams{2}=struct(<span class="string">'name'</span>,{{<span class="string">'testDB1'</span>}},<span class="string">'value'</span>,<span class="keyword">...</span>
0121     {{<span class="string">'testValue1'</span>}});
0122 
0123 evalc(<span class="string">'modelNew=addMets(model,metsToAdd,true);'</span>);
0124 
0125 <span class="comment">%Perform the curation manually for comparison</span>
0126 modelManual=model;
0127 modelManual.metNotes(1:numel(modelManual.mets),1)={<span class="string">''</span>};
0128 modelManual.metCharges(1:numel(modelManual.mets),1)=NaN(numel(modelManual.mets),1);
0129 modelManual.mets(end+1:end+2)={<span class="string">'m_0001'</span>,<span class="string">'m_0002'</span>};
0130 modelManual.metNames(end+1:end+2)=metsToAdd.metNames;
0131 modelManual.metNotes(end+1:end+2)=metsToAdd.metNotes;
0132 modelManual.metMiriams(end+1:end+2)=metsToAdd.metMiriams;
0133 modelManual.metCharges(end+1:end+2)=[2,NaN];
0134 modelManual.b(end+1:end+2)=[0,0];
0135 modelManual.metFormulas(end+1:end+2)={<span class="string">''</span>,<span class="string">'C3H4O7P'</span>};
0136 modelManual.metComps(end+1:end+2)=[1,2];
0137 modelManual.S(end+1:end+2,:)=sparse(zeros(2,numel(modelManual.rxns)));
0138 
0139 verifyEqual(testCase,modelManual,modelNew)
0140 <span class="keyword">end</span>
0141 
0142 
0143 <a name="_sub6" href="#_subfunctions" class="code">function addMets_oneCompTest(testCase)</a>
0144 sourceDir = fileparts(which(mfilename));
0145 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0146 
0147 metsToAdd.metNames={<span class="string">'metaboliteName'</span>,<span class="string">'3-Phospho-D-glycerate'</span>};
0148 metsToAdd.compartments={<span class="string">'e'</span>};
0149 metsToAdd.metCharges=[2,0];
0150 metsToAdd.metNotes={<span class="string">'this is just a test'</span>,<span class="string">'another one'</span>};
0151 metsToAdd.metMiriams{1}=struct(<span class="string">'name'</span>,{{<span class="string">'testDB1'</span>;<span class="string">'testDB2'</span>}},<span class="string">'value'</span>,<span class="keyword">...</span>
0152     {{<span class="string">'testValue1'</span>;<span class="string">'testValue2'</span>}});
0153 metsToAdd.metMiriams{2}=struct(<span class="string">'name'</span>,{{<span class="string">'testDB1'</span>}},<span class="string">'value'</span>,<span class="keyword">...</span>
0154     {{<span class="string">'testValue1'</span>}});
0155 
0156 evalc(<span class="string">'modelNew=addMets(model,metsToAdd,true);'</span>);
0157 
0158 <span class="comment">%Perform the curation manually for comparison</span>
0159 modelManual=model;
0160 modelManual.metNotes(1:numel(modelManual.mets),1)={<span class="string">''</span>};
0161 modelManual.metCharges(1:numel(modelManual.mets),1)=NaN(numel(modelManual.mets),1);
0162 modelManual.mets(end+1:end+2)={<span class="string">'m_0001'</span>,<span class="string">'m_0002'</span>};
0163 modelManual.metNames(end+1:end+2)=metsToAdd.metNames;
0164 modelManual.metNotes(end+1:end+2)=metsToAdd.metNotes;
0165 modelManual.metMiriams(end+1:end+2)=metsToAdd.metMiriams;
0166 modelManual.metCharges(end+1:end+2)=[2,NaN];
0167 modelManual.b(end+1:end+2)=[0,0];
0168 modelManual.metFormulas(end+1:end+2)={<span class="string">''</span>,<span class="string">'C3H4O7P'</span>};
0169 modelManual.metComps(end+1:end+2)=2;
0170 modelManual.S(end+1:end+2,:)=sparse(zeros(2,numel(modelManual.rxns)));
0171 
0172 verifyEqual(testCase,modelManual,modelNew)
0173 <span class="keyword">end</span>
0174 
0175 <a name="_sub7" href="#_subfunctions" class="code">function removeMetsTest(testCase)</a>
0176 sourceDir = fileparts(which(mfilename));
0177 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0178 
0179 modelNew=removeMets(model,<span class="string">'Acetate'</span>,true,true,true,true);
0180 
0181 <span class="comment">%Perform the curation manually for comparison</span>
0182 modelManual=model;
0183 modelManual.mets(6:7)=[];
0184 modelManual.metNames(6:7)=[];
0185 modelManual.metMiriams(6:7)=[];
0186 modelManual.b(6:7)=[];
0187 modelManual.metFormulas(6:7)=[];
0188 modelManual.metComps(6:7)=[];
0189 modelManual.S(6:7,:)=[];
0190 
0191 modelManual.rxnGeneMat(20,:)=[];
0192 modelManual.grRules(20)=[];
0193 modelManual.rxns(20)=[];
0194 modelManual.rxnNames(20)=[];
0195 modelManual.lb(20)=[];
0196 modelManual.ub(20)=[];
0197 modelManual.c(20)=[];
0198 modelManual.rev(20)=[];
0199 modelManual.S(:,20)=[];
0200 modelManual.eccodes(20)=[];
0201 verifyEqual(testCase,modelNew,modelManual)
0202 <span class="keyword">end</span>
0203 
0204 <a name="_sub8" href="#_subfunctions" class="code">function addRxnsTest(testCase)</a>
0205 sourceDir = fileparts(which(mfilename));
0206 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0207 rxnsToAdd.rxns=<span class="string">'test1'</span>;
0208 rxnsToAdd.equations=<span class="string">'2-Oxoglutarate =&gt; TEST'</span>;
0209 rxnsToAdd.rxnNames={<span class="string">'testRxn1'</span>}; <span class="comment">% test cell array</span>
0210 rxnsToAdd.rxnMiriams{1}=struct(<span class="string">'name'</span>,{{<span class="string">'testDB1'</span>;<span class="string">'testDB2'</span>}},<span class="string">'value'</span>,<span class="keyword">...</span>
0211     {{<span class="string">'testValue1'</span>;<span class="string">'testValue2'</span>}});
0212 rxnsToAdd.grRules=&quot;b0008&quot;; <span class="comment">% test string</span>
0213 evalc(<span class="string">'modelNew=addRxns(model,rxnsToAdd,2,''c'',true);'</span>);
0214 
0215 rxnsToAdd.rxns=<span class="string">'test2'</span>;
0216 rxnsToAdd=rmfield(rxnsToAdd,<span class="string">'equations'</span>);
0217 rxnsToAdd.mets={{<span class="string">'6pgl_c'</span>,<span class="string">'atp_c'</span>}};
0218 rxnsToAdd.stoichCoeffs=[[-1,2]];
0219 rxnsToAdd.lb=-1000;
0220 rxnsToAdd.grRules=<span class="string">'test'</span>;
0221 evalc(<span class="string">'modelNew=addRxns(modelNew,rxnsToAdd,1,''c'',true,true);'</span>);
0222 
0223 <span class="comment">%Perform the curation manually for comparison</span>
0224 modelManual=model;
0225 
0226 modelManual.rxnMiriams=cell(numel(modelManual.rxns),1);
0227 modelManual.rxns(end+1:end+2)={<span class="string">'test1'</span>;<span class="string">'test2'</span>};
0228 modelManual.mets(end+1)={<span class="string">'m_0001'</span>};
0229 modelManual.S(end+1,:)=zeros(1,numel(modelManual.rxns)-2);
0230 modelManual.S(:,end+1:end+2)=zeros(numel(modelManual.mets),2);
0231 modelManual.S(<span class="keyword">end</span>,96)=1;
0232 modelManual.S([14,73],end-1)=[-1,1];
0233 modelManual.S([5,17],end)=[-1,2];
0234 modelManual.lb(end+1:end+2)=[0;-1000];
0235 modelManual.ub(end+1:end+2)=[Inf;Inf];
0236 modelManual.rev(end+1:end+2)=[0;1];
0237 modelManual.c(end+1:end+2)=[0;0];
0238 modelManual.b(end+1)=[0];
0239 modelManual.rxnNames(end+1:end+2)={<span class="string">'testRxn1'</span>;<span class="string">'testRxn1'</span>};
0240 modelManual.grRules(end+1:end+2)={<span class="string">'b0008'</span>;<span class="string">'test'</span>};
0241 
0242 modelManual.rxnGeneMat(end+1:end+2,:)=zeros(2,numel(modelManual.genes));
0243 modelManual.rxnGeneMat(:,end+1)=zeros(numel(modelManual.rxns),1);
0244 modelManual.rxnGeneMat(97,end)=1;
0245 modelManual.rxnGeneMat(end-1,1)=1;
0246 modelManual.rxnGeneMat(<span class="keyword">end</span>,138)=1;
0247 
0248 modelManual.eccodes(end+1:end+2)={<span class="string">''</span>;<span class="string">''</span>};
0249 modelManual.genes(end+1)={<span class="string">'test'</span>};
0250 modelManual.geneShortNames(end+1)={<span class="string">''</span>};
0251 modelManual.metNames(end+1)={<span class="string">'TEST'</span>};
0252 modelManual.metComps(end+1)=[1];
0253 modelManual.metFormulas(end+1)={<span class="string">''</span>};
0254 modelManual.metMiriams(end+1)={[]};
0255 modelManual.rxnMiriams(end+1:end+2)={struct(<span class="string">'name'</span>,{{<span class="string">'testDB1'</span>;<span class="string">'testDB2'</span>}},<span class="string">'value'</span>,<span class="keyword">...</span>
0256     {{<span class="string">'testValue1'</span>;<span class="string">'testValue2'</span>}})};
0257 
0258 verifyEqual(testCase,modelManual,modelNew)
0259 <span class="keyword">end</span>
0260 
0261 <a name="_sub9" href="#_subfunctions" class="code">function removeReactionsTest(testCase)</a>
0262 sourceDir = fileparts(which(mfilename));
0263 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0264 
0265 modelNew=removeMets(model,<span class="string">'Acetate'</span>,true,true,true,true);
0266 
0267 <span class="comment">%Perform the curation manually for comparison</span>
0268 modelManual=model;
0269 modelManual.mets(6:7)=[];
0270 modelManual.metNames(6:7)=[];
0271 modelManual.metMiriams(6:7)=[];
0272 modelManual.b(6:7)=[];
0273 modelManual.metFormulas(6:7)=[];
0274 modelManual.metComps(6:7)=[];
0275 modelManual.S(6:7,:)=[];
0276 
0277 modelManual.rxnGeneMat(20,:)=[];
0278 modelManual.grRules(20)=[];
0279 modelManual.rxns(20)=[];
0280 modelManual.rxnNames(20)=[];
0281 modelManual.lb(20)=[];
0282 modelManual.ub(20)=[];
0283 modelManual.c(20)=[];
0284 modelManual.rev(20)=[];
0285 modelManual.S(:,20)=[];
0286 modelManual.eccodes(20)=[];
0287 verifyEqual(testCase,modelNew,modelManual)
0288 <span class="keyword">end</span>
0289 
0290 <a name="_sub10" href="#_subfunctions" class="code">function getMetsInCompTest(testCase)</a>
0291 <span class="comment">%Load the model in RAVEN format</span>
0292 sourceDir=fileparts(fileparts(fileparts(which(mfilename))));
0293 load(fullfile(sourceDir,<span class="string">'testing'</span>,<span class="string">'unit_tests'</span>,<span class="string">'test_data'</span>,<span class="string">'ecoli_textbook.mat'</span>), <span class="string">'model'</span>);
0294 
0295 evalc(<span class="string">'[testOut.I, testOut.metNames]=getMetsInComp(model,''e'');'</span>);
0296 
0297 testCheck.I=[false;false;false;false;false;false;true;false;true;false;false;false;false;false;true;false;false;false;false;true;false;false;false;false;true;false;false;false;true;true;false;true;false;false;true;false;true;false;true;false;false;true;false;true;false;false;true;false;true;false;false;false;false;false;true;false;true;false;false;false;true;false;true;false;false;false;false;false;false;true;false;false];
0298 testCheck.metNames={<span class="string">'Acetate'</span>;<span class="string">'Acetaldehyde'</span>;<span class="string">'2-Oxoglutarate'</span>;<span class="string">'CO2'</span>;<span class="string">'Ethanol'</span>;<span class="string">'Formate'</span>;<span class="string">'D-Fructose'</span>;<span class="string">'Fumarate'</span>;<span class="string">'D-Glucose'</span>;<span class="string">'L-Glutamine'</span>;<span class="string">'L-Glutamate'</span>;<span class="string">'H2O'</span>;<span class="string">'H+'</span>;<span class="string">'D-Lactate'</span>;<span class="string">'L-Malate'</span>;<span class="string">'Ammonium'</span>;<span class="string">'O2'</span>;<span class="string">'Phosphate'</span>;<span class="string">'Pyruvate'</span>;<span class="string">'Succinate'</span>};
0299 verifyEqual(testCase,testOut,testCheck)
0300 <span class="keyword">end</span>
0301 
0302 <a name="_sub11" href="#_subfunctions" class="code">function getRxnsInCompTest(testCase)</a>
0303 <span class="comment">%Load the model in RAVEN format</span>
0304 sourceDir=fileparts(fileparts(fileparts(which(mfilename))));
0305 load(fullfile(sourceDir,<span class="string">'testing'</span>,<span class="string">'unit_tests'</span>,<span class="string">'test_data'</span>,<span class="string">'ecoli_textbook.mat'</span>), <span class="string">'model'</span>);
0306 
0307 evalc(<span class="string">'[testOut.I, testOut.rxnNames]=getRxnsInComp(model,''e'');'</span>);
0308 
0309 testCheck.I=[20;21;22;23;24;25;26;27;28;29;30;31;32;33;34;35;36;37;38;39];
0310 testCheck.rxnNames={<span class="string">'Acetate exchange'</span>;<span class="string">'Acetaldehyde exchange'</span>;<span class="string">'2-Oxoglutarate exchange'</span>;<span class="string">'CO2 exchange'</span>;<span class="string">'Ethanol exchange'</span>;<span class="string">'Formate exchange'</span>;<span class="string">'D-Fructose exchange'</span>;<span class="string">'Fumarate exchange'</span>;<span class="string">'D-Glucose exchange'</span>;<span class="string">'L-Glutamine exchange'</span>;<span class="string">'L-Glutamate exchange'</span>;<span class="string">'H+ exchange'</span>;<span class="string">'H2O exchange'</span>;<span class="string">'D-lactate exchange'</span>;<span class="string">'L-Malate exchange'</span>;<span class="string">'Ammonia exchange'</span>;<span class="string">'O2 exchange'</span>;<span class="string">'Phosphate exchange'</span>;<span class="string">'Pyruvate exchange'</span>;<span class="string">'Succinate exchange'</span>};
0311 verifyEqual(testCase,testOut,testCheck)
0312 <span class="keyword">end</span>
0313 
0314 <a name="_sub12" href="#_subfunctions" class="code">function getAllRxnsFromGenesTest(testCase)</a>
0315 <span class="comment">%Load the model in RAVEN format</span>
0316 sourceDir=fileparts(fileparts(fileparts(which(mfilename))));
0317 load(fullfile(sourceDir,<span class="string">'testing'</span>,<span class="string">'unit_tests'</span>,<span class="string">'test_data'</span>,<span class="string">'ecoli_textbook.mat'</span>), <span class="string">'model'</span>);
0318 evalc(<span class="string">'testOut=getAllRxnsFromGenes(model,''ACONTa'');'</span>);
0319 
0320 testCheck={<span class="string">'ACONTa'</span>;<span class="string">'ACONTb'</span>};
0321 verifyEqual(testCase,testOut,testCheck)
0322 <span class="keyword">end</span>
0323 
0324 <a name="_sub13" href="#_subfunctions" class="code">function changeRxnsTest(testCase)</a>
0325 <span class="comment">%Load the model in RAVEN format</span>
0326 sourceDir=fileparts(fileparts(fileparts(which(mfilename))));
0327 load(fullfile(sourceDir,<span class="string">'testing'</span>,<span class="string">'unit_tests'</span>,<span class="string">'test_data'</span>,<span class="string">'ecoli_textbook.mat'</span>), <span class="string">'model'</span>);
0328 
0329 evalc(<span class="string">'modelNew=changeRxns(model,''ACKr'',''2-Oxoglutarate =&gt; TEST'',2,''c'',true);'</span>);
0330 
0331 <span class="comment">%Perform the curation manually for comparison</span>
0332 modelManual=model;
0333 
0334 modelManual.mets(end+1)={<span class="string">'m_0001'</span>};
0335 modelManual.S(end+1,:)=zeros(1,numel(modelManual.rxns));
0336 modelManual.S(:,3)=0;
0337 modelManual.S([14,73],3)=[-1,1];
0338 
0339 modelManual.metNames(end+1)={<span class="string">'TEST'</span>};
0340 modelManual.metComps(end+1)=[1];
0341 modelManual.metFormulas(end+1)={<span class="string">''</span>};
0342 modelManual.metMiriams(end+1)={[]};
0343 modelManual.b(end+1)=[0];
0344 modelManual.rev(3)=[0];
0345 
0346 verifyEqual(testCase,modelNew,modelManual)
0347 <span class="keyword">end</span>
0348 
0349 <a name="_sub14" href="#_subfunctions" class="code">function removeBadRxnsTest(testCase)</a>
0350 <span class="comment">%Load the model in RAVEN format</span>
0351 sourceDir=fileparts(fileparts(fileparts(which(mfilename))));
0352 load(fullfile(sourceDir,<span class="string">'testing'</span>,<span class="string">'unit_tests'</span>,<span class="string">'test_data'</span>,<span class="string">'ecoli_textbook.mat'</span>), <span class="string">'model'</span>);
0353 
0354 [~,exchRxns]=getExchangeRxns(model);
0355 modelNew=model;
0356 
0357 modelNew.lb(exchRxns)=[0];
0358 modelNew.ub(exchRxns)=[0];
0359 modelNew.lb(modelNew.lb&gt;0)=0;
0360 modelNew.S(17,:)=1;
0361 [~, testOut]=removeBadRxns(modelNew);
0362 evalc(<span class="string">'[~, testOut]=removeBadRxns(modelNew,3,modelNew.metComps==2);'</span>);
0363 
0364 import matlab.unittest.constraints.AnyCellOf;
0365 import matlab.unittest.constraints.ContainsSubstring;
0366 verifyThat(testCase,AnyCellOf({<span class="string">'SUCDi'</span>,<span class="string">'FRD7'</span>}),ContainsSubstring(testOut{:}),<span class="string">'test'</span>)
0367 <span class="comment">%Either SUCDi or FRD7 should be given as output</span>
0368 <span class="keyword">end</span>
0369 
0370 <a name="_sub15" href="#_subfunctions" class="code">function changeGrRulesTest(testCase)</a>
0371 sourceDir = fileparts(which(mfilename));
0372 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0373 
0374 modelNew=changeGrRules(model,{<span class="string">'ACKr'</span>,<span class="string">'ACONTa'</span>},{<span class="string">'b2296 and b1849'</span>;<span class="string">'b1849'</span>},true);
0375 modelNew=changeGrRules(modelNew,<span class="string">'ACONTa'</span>,<span class="string">'b1849'</span>,false);
0376 
0377 <span class="comment">%Perform the curation manually for comparison</span>
0378 modelManual=model;
0379 modelManual.grRules(3:4)={<span class="string">'b2296 and b1849'</span>;<span class="string">'b1849 or b1849'</span>};
0380 modelManual.rxnGeneMat(3:4,:)=0;
0381 modelManual.rxnGeneMat(3,[57,76])=1;
0382 modelManual.rxnGeneMat(4,57)=1;
0383 
0384 verifyEqual(testCase,modelNew,modelManual)
0385 <span class="keyword">end</span>
0386 
0387 <a name="_sub16" href="#_subfunctions" class="code">function copyToCompsTest(testCase)</a>
0388 sourceDir = fileparts(which(mfilename));
0389 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0390 
0391 modelNew=copyToComps(model,{<span class="string">'p'</span>,<span class="string">'e'</span>},<span class="string">'ACKr'</span>);
0392 
0393 <span class="comment">%Perform the curation manually for comparison</span>
0394 modelManual=model;
0395 
0396 modelManual.rxns(end+1:end+2)={<span class="string">'ACKr_p'</span>;<span class="string">'ACKr_e'</span>};
0397 modelManual.mets(end+1:end+7)={<span class="string">'ac_c_p'</span>;<span class="string">'actp_c_p'</span>;<span class="string">'adp_c_p'</span>;<span class="string">'atp_c_p'</span>;<span class="string">'actp_c_e'</span>;<span class="string">'adp_c_e'</span>;<span class="string">'atp_c_e'</span>};
0398 modelManual.S(end+1:end+7,:)=zeros(7,numel(modelManual.rxns)-2);
0399 modelManual.S(:,end+1:end+2)=zeros(numel(modelManual.mets),2);
0400 
0401 modelManual.S([73,74,75,76],end-1)=[1,-1,-1,1];
0402 modelManual.S([7,77,78,79],end)=[1,-1,-1,1];
0403 
0404 modelManual.lb(end+1:end+2)=[-1000;-1000];
0405 modelManual.ub(end+1:end+2)=[1000;1000];
0406 modelManual.rev(end+1:end+2)=[1;1];
0407 modelManual.c(end+1:end+2)=[0;0];
0408 modelManual.rxnNames(end+1:end+2)={<span class="string">'acetate kinase'</span>;<span class="string">'acetate kinase'</span>};
0409 modelManual.grRules(end+1:end+2)={<span class="string">'b1849 or b2296 or b3115'</span>;<span class="string">'b1849 or b2296 or b3115'</span>};
0410 modelManual.eccodes(end+1:end+2)={<span class="string">'2.7.2.1'</span>;<span class="string">'2.7.2.1'</span>};
0411 
0412 modelManual.rxnGeneMat(end+1:end+2,:)=zeros(2,numel(modelManual.genes));
0413 modelManual.rxnGeneMat(end-1:<span class="keyword">end</span>,[57,76,97])=1;
0414 
0415 modelManual.metNames(end+1:end+7)={<span class="string">'Acetate'</span>;<span class="string">'Acetyl phosphate'</span>;<span class="string">'ADP'</span>;<span class="string">'ATP'</span>;<span class="string">'Acetyl phosphate'</span>;<span class="string">'ADP'</span>;<span class="string">'ATP'</span>};
0416 modelManual.metComps(end+1:end+7)=[3;3;3;3;2;2;2];
0417 modelManual.metFormulas(end+1:end+7)={<span class="string">'C2H3O2'</span>;<span class="string">'C2H3O5P'</span>;<span class="string">'C10H12N5O10P2'</span>;<span class="string">'C10H12N5O13P3'</span>;<span class="string">'C2H3O5P'</span>;<span class="string">'C10H12N5O10P2'</span>;<span class="string">'C10H12N5O13P3'</span>};
0418 modelManual.metMiriams(end+1:end+7)=modelManual.metMiriams([6,12,13,17,12,13,17]);
0419 modelManual.b(end+1:end+7)=[0];
0420 
0421 modelManual.comps(end+1)={<span class="string">'p'</span>};
0422 modelManual.compNames(end+1)={<span class="string">'p'</span>};
0423 
0424 verifyEqual(testCase,modelNew,modelManual)
0425 <span class="keyword">end</span>
0426 
0427 <a name="_sub17" href="#_subfunctions" class="code">function setExchangeBoundsTest(testCase)</a>
0428 sourceDir = fileparts(which(mfilename));
0429 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0430 
0431 modelNew=setExchangeBounds(model,{<span class="string">'ac_e'</span>;<span class="string">'akg_e'</span>},-500,500);
0432 
0433 <span class="comment">%Perform the curation manually for comparison</span>
0434 modelManual=model;
0435 
0436 exchRxns=[21;23;24;25;26;27;28;29;30;31;32;33;34;35;36;37;38;39];
0437 modelManual.lb(exchRxns)=0;
0438 modelManual.lb([20,22])=-500;
0439 modelManual.ub([20,22])=500;
0440 
0441 verifyEqual(testCase,modelNew,modelManual)
0442 <span class="keyword">end</span>
0443 
0444 <a name="_sub18" href="#_subfunctions" class="code">function addRxnsGenesMetsTest(testCase)</a>
0445 sourceDir = fileparts(which(mfilename));
0446 load(fullfile(sourceDir,<span class="string">'test_data'</span>,<span class="string">'ecoli_textbook.mat'</span>), <span class="string">'model'</span>);
0447 
0448 sbmlFile=fullfile(sourceDir,<span class="string">'..'</span>,<span class="string">'..'</span>,<span class="string">'tutorial'</span>,<span class="string">'empty.xml'</span>);
0449 evalc(<span class="string">'modelEmpty=importModel(sbmlFile)'</span>); <span class="comment">% Repress warnings</span>
0450 
0451 evalc(<span class="string">'modelNew=addRxnsGenesMets(model,modelEmpty,''r1'',true);'</span>);
0452 
0453 <span class="comment">%Perform the curation manually for comparison</span>
0454 modelManual=model;
0455 
0456 modelManual.rxns(end+1)={<span class="string">'r1'</span>};
0457 modelManual.mets(end+1:end+3)={<span class="string">'m1'</span>;<span class="string">'m2'</span>;<span class="string">'m3'</span>};
0458 modelManual.S(end+1:end+3,:)=zeros(3,numel(modelManual.rxns)-1);
0459 modelManual.S(:,end+1)=zeros(numel(modelManual.mets),1);
0460 modelManual.S([42,73,74,75],end)=[-1,-1,1,1];
0461 
0462 modelManual.lb(end+1)=[0];
0463 modelManual.ub(end+1)=[1000];
0464 modelManual.rev(end+1)=[0];
0465 modelManual.c(end+1)=[0];
0466 modelManual.rxnNames(end+1)={<span class="string">'Breakdown of sucrose (invertase)'</span>};
0467 modelManual.grRules(end+1)={<span class="string">'g1'</span>};
0468 modelManual.eccodes(end+1)={<span class="string">''</span>};
0469 modelManual.rxnNotes(1:numel(modelManual.rxns),1)={<span class="string">''</span>};
0470 modelManual.rxnNotes(end)={<span class="string">'Added via addRxnsGenesMets()'</span>};
0471 modelManual.rxnConfidenceScores(1:numel(modelManual.rxns),1)=NaN;
0472 modelManual.rxnConfidenceScores(end)=[0];
0473 
0474 modelManual.genes(end+1)={<span class="string">'g1'</span>};
0475 modelManual.geneShortNames(end+1)={<span class="string">''</span>};
0476 
0477 modelManual.rxnGeneMat(end+1,:)=zeros(1,numel(modelManual.genes)-1);
0478 modelManual.rxnGeneMat(:,end+1)=zeros(numel(modelManual.rxns),1);
0479 modelManual.rxnGeneMat(<span class="keyword">end</span>,end)=1;
0480 
0481 modelManual.metNames(end+1:end+3)={<span class="string">'sucrose'</span>;<span class="string">'glucose'</span>;<span class="string">'fructose'</span>};
0482 modelManual.metComps(end+1:end+3)=[2;2;2];
0483 modelManual.metFormulas(end+1:end+3)={<span class="string">'C12H22O11'</span>;<span class="string">'C6H12O6'</span>;<span class="string">'C6H12O6'</span>};
0484 modelManual.metMiriams(end+1:end+3)={[];[];[]};
0485 modelManual.b(end+1:end+3)=[0];
0486 
0487 verifyEqual(testCase,modelNew,modelManual)
0488 <span class="keyword">end</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>