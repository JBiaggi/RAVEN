<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of modelCurationTests</title>
  <meta name="keywords" content="modelCurationTests">
  <meta name="description" content="run this test case with the command">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">testing</a> &gt; <a href="index.html">unit_tests</a> &gt; modelCurationTests.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for testing\unit_tests&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>modelCurationTests
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>run this test case with the command</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function tests = modelCurationTests </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">run this test case with the command
results = runtests('modelCurationTests.m')</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function addExchangeRxnsTest(testCase)</a></li><li><a href="#_sub2" class="code">function addTransportTest(testCase)</a></li><li><a href="#_sub3" class="code">function addGenesRavenTest(testCase)</a></li><li><a href="#_sub4" class="code">function removeGenesTest(testCase)</a></li><li><a href="#_sub5" class="code">function addMetsTest(testCase)</a></li><li><a href="#_sub6" class="code">function removeMetsTest(testCase)</a></li><li><a href="#_sub7" class="code">function addRxnsTest(testCase)</a></li><li><a href="#_sub8" class="code">function removeReactionsTest(testCase)</a></li><li><a href="#_sub9" class="code">function getMetsInCompTest(testCase)</a></li><li><a href="#_sub10" class="code">function getRxnsInCompTest(testCase)</a></li><li><a href="#_sub11" class="code">function getAllRxnsFromGenesTest(testCase)</a></li><li><a href="#_sub12" class="code">function changeRxnsTest(testCase)</a></li><li><a href="#_sub13" class="code">function removeBadRxnsTest(testCase)</a></li><li><a href="#_sub14" class="code">function changeGrRulesTest(testCase)</a></li><li><a href="#_sub15" class="code">function copyToCompsTest(testCase)</a></li><li><a href="#_sub16" class="code">function setExchangeBoundsTest(testCase)</a></li><li><a href="#_sub17" class="code">function addRxnsGenesMetsTest(testCase)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%run this test case with the command</span>
0002 <span class="comment">%results = runtests('modelCurationTests.m')</span>
0003 <a name="_sub0" href="#_subfunctions" class="code">function tests = modelCurationTests</a>
0004 tests = functiontests(localfunctions);
0005 <span class="keyword">end</span>
0006 
0007 <a name="_sub1" href="#_subfunctions" class="code">function addExchangeRxnsTest(testCase)</a>
0008 sourceDir = fileparts(which(mfilename));
0009 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0010 
0011 modelNew=addExchangeRxns(model,<span class="string">'both'</span>,<span class="string">'6pgl_c'</span>);
0012 
0013 <span class="comment">%Perform the curation manually for comparison</span>
0014 modelManual=model;
0015 modelManual.rxns(end+1)={<span class="string">'EXC_BOTH_6pgl_c'</span>};
0016 modelManual.lb(end+1)=-1000;
0017 modelManual.ub(end+1)=1000;
0018 modelManual.c(end+1)=0;
0019 modelManual.rev(end+1)=1;
0020 modelManual.rxnNames(end+1)={<span class="string">'6-phospho-D-glucono-1,5-lactone exchange (BOTH)'</span>};
0021 modelManual.grRules(end+1)={<span class="string">''</span>};
0022 modelManual.eccodes(end+1)={<span class="string">''</span>};
0023 modelManual.rxnGeneMat(end+1,:)=sparse(zeros(1,numel(modelManual.genes)));
0024 modelManual.S(:,end+1)=sparse(zeros(numel(modelManual.mets),1));
0025 modelManual.S(5,end)=-1;
0026 
0027 verifyEqual(testCase,modelNew,modelManual)
0028 <span class="keyword">end</span>
0029 
0030 <a name="_sub2" href="#_subfunctions" class="code">function addTransportTest(testCase)</a>
0031 sourceDir = fileparts(which(mfilename));
0032 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0033 
0034 evalc(<span class="string">'modelNew=addTransport(model,''c'',''e'',{''6-phospho-D-glucono-1,5-lactone''},false,false,''test_'');'</span>);
0035 
0036 <span class="comment">%Perform the curation manually for comparison</span>
0037 modelManual=model;
0038 modelManual.rxns(end+1)={<span class="string">'test_0001'</span>};
0039 modelManual.lb(end+1)=0;
0040 modelManual.ub(end+1)=Inf;
0041 modelManual.c(end+1)=0;
0042 modelManual.rev(end+1)=0;
0043 modelManual.rxnNames(end+1)={<span class="string">'6-phospho-D-glucono-1,5-lactone transport, Cytoplasm-Extraorganism'</span>};
0044 modelManual.grRules(end+1)={<span class="string">''</span>};
0045 modelManual.eccodes(end+1)={<span class="string">''</span>};
0046 modelManual.rxnGeneMat(end+1,:)=sparse(zeros(1,numel(modelManual.genes)));
0047 
0048 modelManual.S(:,end+1)=sparse(zeros(numel(modelManual.mets),1));
0049 modelManual.S(end+1,:)=sparse(zeros(1,numel(modelManual.rxns)));
0050 modelManual.S([5,73],end)=[-1,1];
0051 
0052 modelManual.mets(end+1)={<span class="string">'m_0001'</span>};
0053 modelManual.metNames(end+1)={<span class="string">'6-phospho-D-glucono-1,5-lactone'</span>};
0054 modelManual.metMiriams(end+1)=modelManual.metMiriams(5);
0055 modelManual.b(end+1)=[0];
0056 modelManual.metFormulas(end+1)={<span class="string">'C6H9O9P'</span>};
0057 modelManual.metComps(end+1)=[2];
0058 
0059 verifyEqual(testCase,modelNew,modelManual)
0060 <span class="keyword">end</span>
0061 
0062 <a name="_sub3" href="#_subfunctions" class="code">function addGenesRavenTest(testCase)</a>
0063 sourceDir = fileparts(which(mfilename));
0064 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0065 
0066 genesToAdd.genes={<span class="string">'testgene1'</span>,<span class="string">'testgene2'</span>};
0067 genesToAdd.geneShortNames={<span class="string">'short1'</span>,<span class="string">'short2'</span>};
0068 genesToAdd.geneMiriams{1}=struct(<span class="string">'name'</span>,{{<span class="string">'testDB1'</span>;<span class="string">'testDB2'</span>}},<span class="string">'value'</span>,<span class="keyword">...</span>
0069     {{<span class="string">'testValue1'</span>;<span class="string">'testValue2'</span>}});
0070 genesToAdd.geneMiriams{2}=struct(<span class="string">'name'</span>,{{<span class="string">'testDB2'</span>;<span class="string">'testDB1'</span>}},<span class="string">'value'</span>,<span class="keyword">...</span>
0071     {{<span class="string">'testValue2'</span>;<span class="string">'testValue1'</span>}});
0072 
0073 modelNew=addGenesRaven(model,genesToAdd);
0074 
0075 <span class="comment">%Perform the curation manually for comparison</span>
0076 modelManual=model;
0077 modelManual.geneMiriams(1:numel(modelManual.genes),1)={[]};
0078 modelManual.genes(end+1:end+2)=genesToAdd.genes;
0079 modelManual.geneShortNames(end+1:end+2)=genesToAdd.geneShortNames;
0080 modelManual.rxnGeneMat(:,end+1:end+2)=sparse(zeros(numel(modelManual.rxns),2));
0081 modelManual.geneMiriams(end+1:end+2)=genesToAdd.geneMiriams;
0082 verifyEqual(testCase,modelNew,modelManual)
0083 <span class="keyword">end</span>
0084 
0085 <a name="_sub4" href="#_subfunctions" class="code">function removeGenesTest(testCase)</a>
0086 sourceDir = fileparts(which(mfilename));
0087 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0088 
0089 modelNew=removeGenes(model,<span class="string">'b1817'</span>,true,true,false);
0090 
0091 <span class="comment">%Perform the curation manually for comparison</span>
0092 modelManual=model;
0093 modelManual.genes(54)=[];
0094 modelManual.geneShortNames(54)=[];
0095 modelManual.rxnGeneMat(:,54)=[];
0096 modelManual.rxnGeneMat(45,:)=[];
0097 modelManual.grRules(50)={<span class="string">'(b2415 and b1621 and b2417 and b2416) or (b2415 and b2417 and b2416 and b1101)'</span>};
0098 modelManual.grRules(45)=[];
0099 modelManual.rxns(45)=[];
0100 modelManual.rxnNames(45)=[];
0101 modelManual.lb(45)=[];
0102 modelManual.ub(45)=[];
0103 modelManual.c(45)=[];
0104 modelManual.rev(45)=[];
0105 modelManual.S(:,45)=[];
0106 modelManual.eccodes(45)=[];
0107 verifyEqual(testCase,modelNew,modelManual)
0108 <span class="keyword">end</span>
0109 
0110 <a name="_sub5" href="#_subfunctions" class="code">function addMetsTest(testCase)</a>
0111 sourceDir = fileparts(which(mfilename));
0112 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0113 
0114 metsToAdd.metNames={<span class="string">'metaboliteName'</span>,<span class="string">'3-Phospho-D-glycerate'</span>};
0115 metsToAdd.compartments={<span class="string">'c'</span>,<span class="string">'e'</span>};
0116 metsToAdd.metCharges=[2,0];
0117 metsToAdd.metNotes={<span class="string">'this is just a test'</span>,<span class="string">'another one'</span>};
0118 metsToAdd.metMiriams{1}=struct(<span class="string">'name'</span>,{{<span class="string">'testDB1'</span>;<span class="string">'testDB2'</span>}},<span class="string">'value'</span>,<span class="keyword">...</span>
0119     {{<span class="string">'testValue1'</span>;<span class="string">'testValue2'</span>}});
0120 metsToAdd.metMiriams{2}=struct(<span class="string">'name'</span>,{{<span class="string">'testDB1'</span>}},<span class="string">'value'</span>,<span class="keyword">...</span>
0121     {{<span class="string">'testValue1'</span>}});
0122 
0123 evalc(<span class="string">'modelNew=addMets(model,metsToAdd,true);'</span>);
0124 
0125 <span class="comment">%Perform the curation manually for comparison</span>
0126 modelManual=model;
0127 modelManual.metNotes(1:numel(modelManual.mets),1)={<span class="string">''</span>};
0128 modelManual.metCharges(1:numel(modelManual.mets),1)=NaN(numel(modelManual.mets),1);
0129 modelManual.mets(end+1:end+2)={<span class="string">'m_0001'</span>,<span class="string">'m_0002'</span>};
0130 modelManual.metNames(end+1:end+2)=metsToAdd.metNames;
0131 modelManual.metNotes(end+1:end+2)=metsToAdd.metNotes;
0132 modelManual.metMiriams(end+1:end+2)=metsToAdd.metMiriams;
0133 modelManual.metCharges(end+1:end+2)=[2,NaN];
0134 modelManual.b(end+1:end+2)=[0,0];
0135 modelManual.metFormulas(end+1:end+2)={<span class="string">''</span>,<span class="string">'C3H4O7P'</span>};
0136 modelManual.metComps(end+1:end+2)=[1,2];
0137 modelManual.S(end+1:end+2,:)=sparse(zeros(2,numel(modelManual.rxns)));
0138 
0139 verifyEqual(testCase,modelManual,modelNew)
0140 <span class="keyword">end</span>
0141 
0142 <a name="_sub6" href="#_subfunctions" class="code">function removeMetsTest(testCase)</a>
0143 sourceDir = fileparts(which(mfilename));
0144 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0145 
0146 modelNew=removeMets(model,<span class="string">'Acetate'</span>,true,true,true,true);
0147 
0148 <span class="comment">%Perform the curation manually for comparison</span>
0149 modelManual=model;
0150 modelManual.mets(6:7)=[];
0151 modelManual.metNames(6:7)=[];
0152 modelManual.metMiriams(6:7)=[];
0153 modelManual.b(6:7)=[];
0154 modelManual.metFormulas(6:7)=[];
0155 modelManual.metComps(6:7)=[];
0156 modelManual.S(6:7,:)=[];
0157 
0158 modelManual.rxnGeneMat(20,:)=[];
0159 modelManual.grRules(20)=[];
0160 modelManual.rxns(20)=[];
0161 modelManual.rxnNames(20)=[];
0162 modelManual.lb(20)=[];
0163 modelManual.ub(20)=[];
0164 modelManual.c(20)=[];
0165 modelManual.rev(20)=[];
0166 modelManual.S(:,20)=[];
0167 modelManual.eccodes(20)=[];
0168 verifyEqual(testCase,modelNew,modelManual)
0169 <span class="keyword">end</span>
0170 
0171 <a name="_sub7" href="#_subfunctions" class="code">function addRxnsTest(testCase)</a>
0172 sourceDir = fileparts(which(mfilename));
0173 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0174 rxnsToAdd.rxns=<span class="string">'test1'</span>;
0175 rxnsToAdd.equations=<span class="string">'2-Oxoglutarate =&gt; TEST'</span>;
0176 rxnsToAdd.rxnNames={<span class="string">'testRxn1'</span>}; <span class="comment">% test cell array</span>
0177 rxnsToAdd.rxnMiriams{1}=struct(<span class="string">'name'</span>,{{<span class="string">'testDB1'</span>;<span class="string">'testDB2'</span>}},<span class="string">'value'</span>,<span class="keyword">...</span>
0178     {{<span class="string">'testValue1'</span>;<span class="string">'testValue2'</span>}});
0179 rxnsToAdd.grRules=&quot;b0008&quot;; <span class="comment">% test string</span>
0180 evalc(<span class="string">'modelNew=addRxns(model,rxnsToAdd,2,''c'',true);'</span>);
0181 
0182 rxnsToAdd.rxns=<span class="string">'test2'</span>;
0183 rxnsToAdd=rmfield(rxnsToAdd,<span class="string">'equations'</span>);
0184 rxnsToAdd.mets={{<span class="string">'6pgl_c'</span>,<span class="string">'atp_c'</span>}};
0185 rxnsToAdd.stoichCoeffs=[[-1,2]];
0186 rxnsToAdd.lb=-1000;
0187 rxnsToAdd.grRules=<span class="string">'test'</span>;
0188 evalc(<span class="string">'modelNew=addRxns(modelNew,rxnsToAdd,1,''c'',true,true);'</span>);
0189 
0190 <span class="comment">%Perform the curation manually for comparison</span>
0191 modelManual=model;
0192 
0193 modelManual.rxnMiriams=cell(numel(modelManual.rxns),1);
0194 modelManual.rxns(end+1:end+2)={<span class="string">'test1'</span>;<span class="string">'test2'</span>};
0195 modelManual.mets(end+1)={<span class="string">'m_0001'</span>};
0196 modelManual.S(end+1,:)=zeros(1,numel(modelManual.rxns)-2);
0197 modelManual.S(:,end+1:end+2)=zeros(numel(modelManual.mets),2);
0198 modelManual.S(<span class="keyword">end</span>,96)=1;
0199 modelManual.S([14,73],end-1)=[-1,1];
0200 modelManual.S([5,17],end)=[-1,2];
0201 modelManual.lb(end+1:end+2)=[0;-1000];
0202 modelManual.ub(end+1:end+2)=[Inf;Inf];
0203 modelManual.rev(end+1:end+2)=[0;1];
0204 modelManual.c(end+1:end+2)=[0;0];
0205 modelManual.b(end+1)=[0];
0206 modelManual.rxnNames(end+1:end+2)={<span class="string">'testRxn1'</span>;<span class="string">'testRxn1'</span>};
0207 modelManual.grRules(end+1:end+2)={<span class="string">'b0008'</span>;<span class="string">'test'</span>};
0208 
0209 modelManual.rxnGeneMat(end+1:end+2,:)=zeros(2,numel(modelManual.genes));
0210 modelManual.rxnGeneMat(:,end+1)=zeros(numel(modelManual.rxns),1);
0211 modelManual.rxnGeneMat(97,end)=1;
0212 modelManual.rxnGeneMat(end-1,1)=1;
0213 modelManual.rxnGeneMat(<span class="keyword">end</span>,138)=1;
0214 
0215 modelManual.eccodes(end+1:end+2)={<span class="string">''</span>;<span class="string">''</span>};
0216 modelManual.genes(end+1)={<span class="string">'test'</span>};
0217 modelManual.geneShortNames(end+1)={<span class="string">''</span>};
0218 modelManual.metNames(end+1)={<span class="string">'TEST'</span>};
0219 modelManual.metComps(end+1)=[1];
0220 modelManual.metFormulas(end+1)={<span class="string">''</span>};
0221 modelManual.metMiriams(end+1)={[]};
0222 modelManual.rxnMiriams(end+1:end+2)={struct(<span class="string">'name'</span>,{{<span class="string">'testDB1'</span>;<span class="string">'testDB2'</span>}},<span class="string">'value'</span>,<span class="keyword">...</span>
0223     {{<span class="string">'testValue1'</span>;<span class="string">'testValue2'</span>}})};
0224 
0225 verifyEqual(testCase,modelManual,modelNew)
0226 <span class="keyword">end</span>
0227 
0228 <a name="_sub8" href="#_subfunctions" class="code">function removeReactionsTest(testCase)</a>
0229 sourceDir = fileparts(which(mfilename));
0230 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0231 
0232 modelNew=removeMets(model,<span class="string">'Acetate'</span>,true,true,true,true);
0233 
0234 <span class="comment">%Perform the curation manually for comparison</span>
0235 modelManual=model;
0236 modelManual.mets(6:7)=[];
0237 modelManual.metNames(6:7)=[];
0238 modelManual.metMiriams(6:7)=[];
0239 modelManual.b(6:7)=[];
0240 modelManual.metFormulas(6:7)=[];
0241 modelManual.metComps(6:7)=[];
0242 modelManual.S(6:7,:)=[];
0243 
0244 modelManual.rxnGeneMat(20,:)=[];
0245 modelManual.grRules(20)=[];
0246 modelManual.rxns(20)=[];
0247 modelManual.rxnNames(20)=[];
0248 modelManual.lb(20)=[];
0249 modelManual.ub(20)=[];
0250 modelManual.c(20)=[];
0251 modelManual.rev(20)=[];
0252 modelManual.S(:,20)=[];
0253 modelManual.eccodes(20)=[];
0254 verifyEqual(testCase,modelNew,modelManual)
0255 <span class="keyword">end</span>
0256 
0257 <a name="_sub9" href="#_subfunctions" class="code">function getMetsInCompTest(testCase)</a>
0258 <span class="comment">%Load the model in RAVEN format</span>
0259 sourceDir=fileparts(fileparts(fileparts(which(mfilename))));
0260 load(fullfile(sourceDir,<span class="string">'testing'</span>,<span class="string">'unit_tests'</span>,<span class="string">'test_data'</span>,<span class="string">'ecoli_textbook.mat'</span>), <span class="string">'model'</span>);
0261 
0262 evalc(<span class="string">'[testOut.I, testOut.metNames]=getMetsInComp(model,''e'');'</span>);
0263 
0264 testCheck.I=[false;false;false;false;false;false;true;false;true;false;false;false;false;false;true;false;false;false;false;true;false;false;false;false;true;false;false;false;true;true;false;true;false;false;true;false;true;false;true;false;false;true;false;true;false;false;true;false;true;false;false;false;false;false;true;false;true;false;false;false;true;false;true;false;false;false;false;false;false;true;false;false];
0265 testCheck.metNames={<span class="string">'Acetate'</span>;<span class="string">'Acetaldehyde'</span>;<span class="string">'2-Oxoglutarate'</span>;<span class="string">'CO2'</span>;<span class="string">'Ethanol'</span>;<span class="string">'Formate'</span>;<span class="string">'D-Fructose'</span>;<span class="string">'Fumarate'</span>;<span class="string">'D-Glucose'</span>;<span class="string">'L-Glutamine'</span>;<span class="string">'L-Glutamate'</span>;<span class="string">'H2O'</span>;<span class="string">'H+'</span>;<span class="string">'D-Lactate'</span>;<span class="string">'L-Malate'</span>;<span class="string">'Ammonium'</span>;<span class="string">'O2'</span>;<span class="string">'Phosphate'</span>;<span class="string">'Pyruvate'</span>;<span class="string">'Succinate'</span>};
0266 verifyEqual(testCase,testOut,testCheck)
0267 <span class="keyword">end</span>
0268 
0269 <a name="_sub10" href="#_subfunctions" class="code">function getRxnsInCompTest(testCase)</a>
0270 <span class="comment">%Load the model in RAVEN format</span>
0271 sourceDir=fileparts(fileparts(fileparts(which(mfilename))));
0272 load(fullfile(sourceDir,<span class="string">'testing'</span>,<span class="string">'unit_tests'</span>,<span class="string">'test_data'</span>,<span class="string">'ecoli_textbook.mat'</span>), <span class="string">'model'</span>);
0273 
0274 evalc(<span class="string">'[testOut.I, testOut.rxnNames]=getRxnsInComp(model,''e'');'</span>);
0275 
0276 testCheck.I=[20;21;22;23;24;25;26;27;28;29;30;31;32;33;34;35;36;37;38;39];
0277 testCheck.rxnNames={<span class="string">'Acetate exchange'</span>;<span class="string">'Acetaldehyde exchange'</span>;<span class="string">'2-Oxoglutarate exchange'</span>;<span class="string">'CO2 exchange'</span>;<span class="string">'Ethanol exchange'</span>;<span class="string">'Formate exchange'</span>;<span class="string">'D-Fructose exchange'</span>;<span class="string">'Fumarate exchange'</span>;<span class="string">'D-Glucose exchange'</span>;<span class="string">'L-Glutamine exchange'</span>;<span class="string">'L-Glutamate exchange'</span>;<span class="string">'H+ exchange'</span>;<span class="string">'H2O exchange'</span>;<span class="string">'D-lactate exchange'</span>;<span class="string">'L-Malate exchange'</span>;<span class="string">'Ammonia exchange'</span>;<span class="string">'O2 exchange'</span>;<span class="string">'Phosphate exchange'</span>;<span class="string">'Pyruvate exchange'</span>;<span class="string">'Succinate exchange'</span>};
0278 verifyEqual(testCase,testOut,testCheck)
0279 <span class="keyword">end</span>
0280 
0281 <a name="_sub11" href="#_subfunctions" class="code">function getAllRxnsFromGenesTest(testCase)</a>
0282 <span class="comment">%Load the model in RAVEN format</span>
0283 sourceDir=fileparts(fileparts(fileparts(which(mfilename))));
0284 load(fullfile(sourceDir,<span class="string">'testing'</span>,<span class="string">'unit_tests'</span>,<span class="string">'test_data'</span>,<span class="string">'ecoli_textbook.mat'</span>), <span class="string">'model'</span>);
0285 evalc(<span class="string">'testOut=getAllRxnsFromGenes(model,''ACONTa'');'</span>);
0286 
0287 testCheck={<span class="string">'ACONTa'</span>;<span class="string">'ACONTb'</span>};
0288 verifyEqual(testCase,testOut,testCheck)
0289 <span class="keyword">end</span>
0290 
0291 <a name="_sub12" href="#_subfunctions" class="code">function changeRxnsTest(testCase)</a>
0292 <span class="comment">%Load the model in RAVEN format</span>
0293 sourceDir=fileparts(fileparts(fileparts(which(mfilename))));
0294 load(fullfile(sourceDir,<span class="string">'testing'</span>,<span class="string">'unit_tests'</span>,<span class="string">'test_data'</span>,<span class="string">'ecoli_textbook.mat'</span>), <span class="string">'model'</span>);
0295 
0296 evalc(<span class="string">'modelNew=changeRxns(model,''ACKr'',''2-Oxoglutarate =&gt; TEST'',2,''c'',true);'</span>);
0297 
0298 <span class="comment">%Perform the curation manually for comparison</span>
0299 modelManual=model;
0300 
0301 modelManual.mets(end+1)={<span class="string">'m_0001'</span>};
0302 modelManual.S(end+1,:)=zeros(1,numel(modelManual.rxns));
0303 modelManual.S(:,3)=0;
0304 modelManual.S([14,73],3)=[-1,1];
0305 
0306 modelManual.metNames(end+1)={<span class="string">'TEST'</span>};
0307 modelManual.metComps(end+1)=[1];
0308 modelManual.metFormulas(end+1)={<span class="string">''</span>};
0309 modelManual.metMiriams(end+1)={[]};
0310 modelManual.b(end+1)=[0];
0311 modelManual.rev(3)=[0];
0312 
0313 verifyEqual(testCase,modelNew,modelManual)
0314 <span class="keyword">end</span>
0315 
0316 <a name="_sub13" href="#_subfunctions" class="code">function removeBadRxnsTest(testCase)</a>
0317 <span class="comment">%Load the model in RAVEN format</span>
0318 sourceDir=fileparts(fileparts(fileparts(which(mfilename))));
0319 load(fullfile(sourceDir,<span class="string">'testing'</span>,<span class="string">'unit_tests'</span>,<span class="string">'test_data'</span>,<span class="string">'ecoli_textbook.mat'</span>), <span class="string">'model'</span>);
0320 
0321 [~,exchRxns]=getExchangeRxns(model);
0322 modelNew=model;
0323 
0324 modelNew.lb(exchRxns)=[0];
0325 modelNew.ub(exchRxns)=[0];
0326 modelNew.lb(modelNew.lb&gt;0)=0;
0327 modelNew.S(17,:)=1;
0328 [~, testOut]=removeBadRxns(modelNew);
0329 evalc(<span class="string">'[~, testOut]=removeBadRxns(modelNew,3,modelNew.metComps==2);'</span>);
0330 
0331 import matlab.unittest.constraints.AnyCellOf;
0332 import matlab.unittest.constraints.ContainsSubstring;
0333 verifyThat(testCase,AnyCellOf({<span class="string">'SUCDi'</span>,<span class="string">'FRD7'</span>}),ContainsSubstring(testOut{:}),<span class="string">'test'</span>)
0334 <span class="comment">%Either SUCDi or FRD7 should be given as output</span>
0335 <span class="keyword">end</span>
0336 
0337 <a name="_sub14" href="#_subfunctions" class="code">function changeGrRulesTest(testCase)</a>
0338 sourceDir = fileparts(which(mfilename));
0339 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0340 
0341 modelNew=changeGrRules(model,{<span class="string">'ACKr'</span>,<span class="string">'ACONTa'</span>},{<span class="string">'b2296 and b1849'</span>;<span class="string">'b1849'</span>},true);
0342 modelNew=changeGrRules(modelNew,<span class="string">'ACONTa'</span>,<span class="string">'b1849'</span>,false);
0343 
0344 <span class="comment">%Perform the curation manually for comparison</span>
0345 modelManual=model;
0346 modelManual.grRules(3:4)={<span class="string">'b2296 and b1849'</span>;<span class="string">'b1849 or b1849'</span>};
0347 modelManual.rxnGeneMat(3:4,:)=0;
0348 modelManual.rxnGeneMat(3,[57,76])=1;
0349 modelManual.rxnGeneMat(4,57)=1;
0350 
0351 verifyEqual(testCase,modelNew,modelManual)
0352 <span class="keyword">end</span>
0353 
0354 <a name="_sub15" href="#_subfunctions" class="code">function copyToCompsTest(testCase)</a>
0355 sourceDir = fileparts(which(mfilename));
0356 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0357 
0358 modelNew=copyToComps(model,{<span class="string">'p'</span>,<span class="string">'e'</span>},<span class="string">'ACKr'</span>);
0359 
0360 <span class="comment">%Perform the curation manually for comparison</span>
0361 modelManual=model;
0362 
0363 modelManual.rxns(end+1:end+2)={<span class="string">'ACKr_p'</span>;<span class="string">'ACKr_e'</span>};
0364 modelManual.mets(end+1:end+7)={<span class="string">'ac_c_p'</span>;<span class="string">'actp_c_p'</span>;<span class="string">'adp_c_p'</span>;<span class="string">'atp_c_p'</span>;<span class="string">'actp_c_e'</span>;<span class="string">'adp_c_e'</span>;<span class="string">'atp_c_e'</span>};
0365 modelManual.S(end+1:end+7,:)=zeros(7,numel(modelManual.rxns)-2);
0366 modelManual.S(:,end+1:end+2)=zeros(numel(modelManual.mets),2);
0367 
0368 modelManual.S([73,74,75,76],end-1)=[-1,1,1,-1];
0369 modelManual.S([7,77,78,79],end)=[-1,1,1,-1];
0370 
0371 modelManual.lb(end+1:end+2)=[-1000;-1000];
0372 modelManual.ub(end+1:end+2)=[1000;1000];
0373 modelManual.rev(end+1:end+2)=[1;1];
0374 modelManual.c(end+1:end+2)=[0;0];
0375 modelManual.rxnNames(end+1:end+2)={<span class="string">'acetate kinase'</span>;<span class="string">'acetate kinase'</span>};
0376 modelManual.grRules(end+1:end+2)={<span class="string">'b2296 or b1849 or b3115'</span>;<span class="string">'b2296 or b1849 or b3115'</span>};
0377 modelManual.eccodes(end+1:end+2)={<span class="string">'2.7.2.1'</span>;<span class="string">'2.7.2.1'</span>};
0378 
0379 modelManual.rxnGeneMat(end+1:end+2,:)=zeros(2,numel(modelManual.genes));
0380 modelManual.rxnGeneMat(end-1:<span class="keyword">end</span>,[57,76,97])=1;
0381 
0382 modelManual.metNames(end+1:end+7)={<span class="string">'Acetate'</span>;<span class="string">'Acetyl phosphate'</span>;<span class="string">'ADP'</span>;<span class="string">'ATP'</span>;<span class="string">'Acetyl phosphate'</span>;<span class="string">'ADP'</span>;<span class="string">'ATP'</span>};
0383 modelManual.metComps(end+1:end+7)=[3;3;3;3;2;2;2];
0384 modelManual.metFormulas(end+1:end+7)={<span class="string">'C2H3O2'</span>;<span class="string">'C2H3O5P'</span>;<span class="string">'C10H12N5O10P2'</span>;<span class="string">'C10H12N5O13P3'</span>;<span class="string">'C2H3O5P'</span>;<span class="string">'C10H12N5O10P2'</span>;<span class="string">'C10H12N5O13P3'</span>};
0385 modelManual.metMiriams(end+1:end+7)=modelManual.metMiriams([6,12,13,17,12,13,17]);
0386 modelManual.b(end+1:end+7)=[0];
0387 
0388 modelManual.comps(end+1)={<span class="string">'p'</span>};
0389 modelManual.compNames(end+1)={<span class="string">'p'</span>};
0390 
0391 verifyEqual(testCase,modelNew,modelManual)
0392 <span class="keyword">end</span>
0393 
0394 <a name="_sub16" href="#_subfunctions" class="code">function setExchangeBoundsTest(testCase)</a>
0395 sourceDir = fileparts(which(mfilename));
0396 load([sourceDir,<span class="string">'/test_data/ecoli_textbook.mat'</span>], <span class="string">'model'</span>);
0397 
0398 modelNew=setExchangeBounds(model,{<span class="string">'ac_e'</span>;<span class="string">'akg_e'</span>},-500,500);
0399 
0400 <span class="comment">%Perform the curation manually for comparison</span>
0401 modelManual=model;
0402 
0403 exchRxns=[21;23;24;25;26;27;28;29;30;31;32;33;34;35;36;37;38;39];
0404 modelManual.lb(exchRxns)=0;
0405 modelManual.lb([20,22])=-500;
0406 modelManual.ub([20,22])=500;
0407 
0408 verifyEqual(testCase,modelNew,modelManual)
0409 <span class="keyword">end</span>
0410 
0411 <a name="_sub17" href="#_subfunctions" class="code">function addRxnsGenesMetsTest(testCase)</a>
0412 sourceDir = fileparts(which(mfilename));
0413 load(fullfile(sourceDir,<span class="string">'test_data'</span>,<span class="string">'ecoli_textbook.mat'</span>), <span class="string">'model'</span>);
0414 
0415 sbmlFile=fullfile(sourceDir,<span class="string">'..'</span>,<span class="string">'..'</span>,<span class="string">'tutorial'</span>,<span class="string">'empty.xml'</span>);
0416 evalc(<span class="string">'modelEmpty=importModel(sbmlFile)'</span>); <span class="comment">% Repress warnings</span>
0417 
0418 evalc(<span class="string">'modelNew=addRxnsGenesMets(model,modelEmpty,''r1'',true);'</span>);
0419 
0420 <span class="comment">%Perform the curation manually for comparison</span>
0421 modelManual=model;
0422 
0423 modelManual.rxns(end+1)={<span class="string">'r1'</span>};
0424 modelManual.mets(end+1:end+3)={<span class="string">'m1'</span>;<span class="string">'m2'</span>;<span class="string">'m3'</span>};
0425 modelManual.S(end+1:end+3,:)=zeros(3,numel(modelManual.rxns)-1);
0426 modelManual.S(:,end+1)=zeros(numel(modelManual.mets),1);
0427 modelManual.S([42,73,74,75],end)=[-1,-1,1,1];
0428 
0429 modelManual.lb(end+1)=[0];
0430 modelManual.ub(end+1)=[1000];
0431 modelManual.rev(end+1)=[0];
0432 modelManual.c(end+1)=[0];
0433 modelManual.rxnNames(end+1)={<span class="string">'Breakdown of sucrose (invertase)'</span>};
0434 modelManual.grRules(end+1)={<span class="string">'g1'</span>};
0435 modelManual.eccodes(end+1)={<span class="string">''</span>};
0436 modelManual.rxnNotes(1:numel(modelManual.rxns),1)={<span class="string">''</span>};
0437 modelManual.rxnNotes(end)={<span class="string">'Added via addRxnsGenesMets()'</span>};
0438 modelManual.rxnConfidenceScores(1:numel(modelManual.rxns),1)=NaN;
0439 modelManual.rxnConfidenceScores(end)=[0];
0440 
0441 modelManual.genes(end+1)={<span class="string">'g1'</span>};
0442 modelManual.geneShortNames(end+1)={<span class="string">''</span>};
0443 
0444 modelManual.rxnGeneMat(end+1,:)=zeros(1,numel(modelManual.genes)-1);
0445 modelManual.rxnGeneMat(:,end+1)=zeros(numel(modelManual.rxns),1);
0446 modelManual.rxnGeneMat(<span class="keyword">end</span>,end)=1;
0447 
0448 modelManual.metNames(end+1:end+3)={<span class="string">'sucrose'</span>;<span class="string">'glucose'</span>;<span class="string">'fructose'</span>};
0449 modelManual.metComps(end+1:end+3)=[2;2;2];
0450 modelManual.metFormulas(end+1:end+3)={<span class="string">'C12H22O11'</span>;<span class="string">'C6H12O6'</span>;<span class="string">'C6H12O6'</span>};
0451 modelManual.metMiriams(end+1:end+3)={[];[];[]};
0452 modelManual.b(end+1:end+3)=[0];
0453 
0454 verifyEqual(testCase,modelNew,modelManual)
0455 <span class="keyword">end</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>