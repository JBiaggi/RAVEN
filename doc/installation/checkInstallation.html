<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of checkInstallation</title>
  <meta name="keywords" content="checkInstallation">
  <meta name="description" content="checkInstallation">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">installation</a> &gt; checkInstallation.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for installation&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>checkInstallation
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>checkInstallation</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function checkInstallation(develMode) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> checkInstallation
   The purpose of this function is to check if all necessary functions are
   installed and working. It also checks whether there are any functions
   with overlapping names between RAVEN and other toolboxes or
   user-defined functions, which are accessible from MATLAB pathlist

   Input: 
   develMode       logical indicating development mode, which includes
                   testing of binaries that are required to update KEGG
                   HMMs (opt, default false)

   Usage: checkInstallation(develMode)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="checkFunctionUniqueness.html" class="code" title="function checkFunctionUniqueness()">checkFunctionUniqueness</a>	checkFunctionUniqueness</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function interpretResults(results)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function checkInstallation(develMode)</a>
0002 <span class="comment">% checkInstallation</span>
0003 <span class="comment">%   The purpose of this function is to check if all necessary functions are</span>
0004 <span class="comment">%   installed and working. It also checks whether there are any functions</span>
0005 <span class="comment">%   with overlapping names between RAVEN and other toolboxes or</span>
0006 <span class="comment">%   user-defined functions, which are accessible from MATLAB pathlist</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%   Input:</span>
0009 <span class="comment">%   develMode       logical indicating development mode, which includes</span>
0010 <span class="comment">%                   testing of binaries that are required to update KEGG</span>
0011 <span class="comment">%                   HMMs (opt, default false)</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%   Usage: checkInstallation(develMode)</span>
0014 
0015 <span class="keyword">if</span> nargin&lt;1
0016     develMode=false;
0017 <span class="keyword">end</span>
0018 
0019 <span class="comment">%Check if RAVEN is in the MATLAB path list</span>
0020 paths=textscan(path,<span class="string">'%s'</span>,<span class="string">'delimiter'</span>, pathsep);
0021 paths=paths{1};
0022 
0023 <span class="comment">%Get the RAVEN path</span>
0024 ravenDir=findRAVENroot();
0025 
0026 fprintf(<span class="string">'\n*** THE RAVEN TOOLBOX ***\n\n'</span>);
0027 <span class="comment">%Print the RAVEN version if it is not the development version</span>
0028 fprintf(<span class="string">' &gt; Checking RAVEN release:\t\t\t\t\t\t\t\t'</span>);
0029 <span class="keyword">if</span> exist(fullfile(ravenDir,<span class="string">'version.txt'</span>), <span class="string">'file'</span>) == 2
0030     fprintf([fgetl(fopen(fullfile(ravenDir,<span class="string">'version.txt'</span>))) <span class="string">'\n'</span>]);
0031     fclose(<span class="string">'all'</span>);
0032 <span class="keyword">else</span>
0033     fprintf(<span class="string">'DEVELOPMENT\n'</span>);
0034 <span class="keyword">end</span>
0035 fprintf([<span class="string">' &gt; Checking MATLAB release:\t\t\t\t\t\t\t\t'</span> version(<span class="string">'-release'</span>) <span class="string">'\n'</span>]);
0036 fprintf(<span class="string">' &gt; Ensure that RAVEN is on the MATLAB path:\t\t\t\t'</span>);
0037 subpath=regexp(genpath(ravenDir),pathsep,<span class="string">'split'</span>); <span class="comment">%List all subdirectories</span>
0038 pathsToKeep=cellfun(@(x) isempty(strfind(x,<span class="string">'.git'</span>)),subpath) &amp; cellfun(@(x) isempty(strfind(x,<span class="string">'doc'</span>)),subpath);
0039 addpath(strjoin(subpath(pathsToKeep),pathsep));
0040 savepath
0041 fprintf(<span class="string">'Pass\n'</span>);
0042 
0043 excelFile=fullfile(ravenDir,<span class="string">'tutorial'</span>,<span class="string">'empty.xlsx'</span>);
0044 xmlFile=fullfile(ravenDir,<span class="string">'tutorial'</span>,<span class="string">'empty.xml'</span>);
0045 matFile=fullfile(ravenDir,<span class="string">'tutorial'</span>,<span class="string">'empty.mat'</span>);
0046 ymlFile=fullfile(ravenDir,<span class="string">'tutorial'</span>,<span class="string">'empty.yml'</span>);
0047 
0048 <span class="comment">%Get the OS specific binary ending (e.g. exe for Windows)</span>
0049 <span class="comment">% binEnd = binaryEnding();</span>
0050 
0051 <span class="comment">%Check if it is possible to parse an Excel file</span>
0052 fprintf(<span class="string">'\n=== Model import and export ===\n'</span>);
0053 fprintf(<span class="string">' &gt; Add Java paths for Excel format\t\t\t\t\t\t'</span>)
0054 <span class="keyword">try</span>
0055     <span class="comment">%Add the required classes to the static Java path if not already added</span>
0056     addJavaPaths();
0057     fprintf(<span class="string">'Pass\n'</span>)
0058 <span class="keyword">catch</span>
0059     fprintf(<span class="string">'Fail\n'</span>)
0060 <span class="keyword">end</span>
0061 fprintf(<span class="string">' &gt; Check libSBML version\t\t\t\t\t\t\t\t'</span>)
0062 <span class="keyword">try</span>
0063     evalc(<span class="string">'importModel(fullfile(ravenDir,''tutorial'',''empty.xml''))'</span>);
0064     <span class="keyword">try</span>
0065         libSBMLver=OutputSBML; <span class="comment">% Only works in libSBML 5.17.0+</span>
0066         fprintf([libSBMLver.libSBML_version_string <span class="string">'\n'</span>]);
0067     <span class="keyword">catch</span>
0068         fprintf(<span class="string">'Fail\n'</span>)
0069         fprintf(<span class="string">'   An older libSBML version was found, update to version 5.17.0 or higher for a significant improvement of model import\n'</span>);
0070     <span class="keyword">end</span>
0071 <span class="keyword">catch</span>
0072     fprintf(<span class="string">'Fail\n'</span>)
0073     fprintf(<span class="string">'   Download libSBML from http://sbml.org/Software/libSBML/Downloading_libSBML and add to MATLAB path\n'</span>);
0074 <span class="keyword">end</span>
0075 
0076 fprintf(<span class="string">' &gt; Checking model import and export:\n'</span>);
0077 
0078 res=runtests(<span class="string">'importExportTests.m'</span>,<span class="string">'OutputDetail'</span>,0);
0079 fprintf(<span class="string">'   &gt; Import Excel format\t\t\t\t\t\t\t\t'</span>)
0080 <span class="keyword">if</span> res(1).Passed == 1
0081     fprintf(<span class="string">'Pass\n'</span>)
0082 <span class="keyword">else</span>
0083     fprintf(<span class="string">'Fail\n'</span>)
0084 <span class="keyword">end</span>
0085 fprintf(<span class="string">'   &gt; Export Excel format\t\t\t\t\t\t\t\t'</span>)
0086 <span class="keyword">if</span> res(3).Passed == 1
0087     fprintf(<span class="string">'Pass\n'</span>)
0088 <span class="keyword">else</span>
0089     fprintf(<span class="string">'Fail\n'</span>)
0090 <span class="keyword">end</span>
0091 fprintf(<span class="string">'   &gt; Import SBML format\t\t\t\t\t\t\t\t\t'</span>)
0092 <span class="keyword">if</span> res(2).Passed == 1
0093     fprintf(<span class="string">'Pass\n'</span>)
0094 <span class="keyword">else</span>
0095     fprintf(<span class="string">'Fail\n'</span>)
0096 <span class="keyword">end</span>
0097 fprintf(<span class="string">'   &gt; Export SBML format\t\t\t\t\t\t\t\t\t'</span>)
0098 <span class="keyword">if</span> res(4).Passed == 1
0099     fprintf(<span class="string">'Pass\n'</span>)
0100 <span class="keyword">else</span>
0101     fprintf(<span class="string">'Fail\n'</span>)
0102 <span class="keyword">end</span>
0103 
0104 <span class="comment">%Check if it is possible to import an SBML model using libSBML</span>
0105 
0106 <span class="comment">%Check if it is possible to import an YAML model</span>
0107 <span class="comment">% fprintf(' &gt; Checking import of model in YAML format:\t\t\t');</span>
0108 <span class="comment">% try</span>
0109 <span class="comment">%     readYaml(ymlFile,true);</span>
0110 <span class="comment">%     fprintf('Pass\n');</span>
0111 <span class="comment">% catch</span>
0112 <span class="comment">%     fprintf('Fail\n');</span>
0113 <span class="comment">% end</span>
0114 
0115 fprintf(<span class="string">'\n=== Model solvers ===\n'</span>);
0116 <span class="comment">%Define values for keepSolver and workingSolvers, needed for solver</span>
0117 <span class="comment">%functionality check</span>
0118 keepSolver=false;
0119 workingSolvers=<span class="string">''</span>;
0120 <span class="comment">%Get current solver. Set it to 'none', if it is not set</span>
0121 fprintf(<span class="string">' &gt; Checking for functional solvers:\n'</span>);
0122 res=runtests(<span class="string">'solverTests.m'</span>,<span class="string">'OutputDetail'</span>,0);
0123 fprintf(<span class="string">'   &gt; glpk\t\t\t\t\t\t\t\t\t\t\t\t'</span>)
0124 <span class="keyword">if</span> res(1).Passed == 1
0125     fprintf(<span class="string">'Pass\n'</span>)
0126 <span class="keyword">else</span>
0127     fprintf(<span class="string">'Fail\n'</span>)
0128 <span class="keyword">end</span>
0129 fprintf(<span class="string">'   &gt; gurobi\t\t\t\t\t\t\t\t\t\t\t\t'</span>)
0130 <span class="keyword">if</span> res(2).Passed == 1
0131     fprintf(<span class="string">'Pass\n'</span>)
0132 <span class="keyword">else</span>
0133     fprintf(<span class="string">'Fail\n'</span>)
0134 <span class="keyword">end</span>
0135 fprintf(<span class="string">'   &gt; cobra\t\t\t\t\t\t\t\t\t\t\t\t'</span>)
0136 <span class="keyword">if</span> res(3).Passed == 1
0137     fprintf(<span class="string">'Pass\n'</span>)
0138 <span class="keyword">else</span>
0139     fprintf(<span class="string">'Fail\n'</span>)
0140 <span class="keyword">end</span>
0141 
0142 fprintf(<span class="string">' &gt; Current RAVEN solver preference:\t\t\t\t\t\t'</span>)
0143 <span class="keyword">if</span> ~ispref(<span class="string">'RAVEN'</span>,<span class="string">'solver'</span>)
0144     fprintf(<span class="string">'None\n'</span>)
0145 <span class="keyword">else</span>
0146     oldSolver=getpref(<span class="string">'RAVEN'</span>,<span class="string">'solver'</span>);
0147     fprintf([oldSolver,<span class="string">'\n'</span>]);
0148     solverIdx=strcmp(oldSolver,{<span class="string">'glpk'</span>,<span class="string">'gurobi'</span>,<span class="string">'cobra'</span>});
0149 <span class="keyword">end</span>
0150 fprintf(<span class="string">' &gt; New RAVEN solver preference:\t\t\t\t\t\t\t'</span>)
0151 <span class="comment">% Order of preference: gurobi &gt; glpk &gt; cobra</span>
0152 <span class="keyword">if</span> exist(<span class="string">'oldSolver'</span>,<span class="string">'var'</span>) &amp;&amp; res(solverIdx).Passed == 1
0153     fprintf([oldSolver <span class="string">' (unchanged)\n'</span>])
0154     setRavenSolver(oldSolver);
0155 <span class="keyword">elseif</span> res(2).Passed == 1
0156     fprintf(<span class="string">'gurobi\n'</span>)
0157     setRavenSolver(<span class="string">'gurobi'</span>);
0158 <span class="keyword">elseif</span> res(1).Passed == 1
0159     fprintf(<span class="string">'glpk\n'</span>)
0160     setRavenSolver(<span class="string">'glpk'</span>);
0161 <span class="keyword">elseif</span> res(3).Passed == 1
0162     fprintf(<span class="string">'cobra\n'</span>)
0163     setRavenSolver(<span class="string">'cobra'</span>);
0164 <span class="keyword">else</span>
0165     fprintf(<span class="string">'None, no functional solvers\n'</span>)
0166     fprintf(<span class="string">'    The glpk should always be working, check your RAVEN installation to make sure all files are present\n'</span>)
0167 <span class="keyword">end</span>
0168 
0169 fprintf(<span class="string">'\n=== Essential binary executables ===\n'</span>);
0170 fprintf(<span class="string">' &gt; Checking BLAST+:\t\t\t\t\t\t\t\t\t\t'</span>);
0171 res=runtests(<span class="string">'blastPlusTests.m'</span>,<span class="string">'OutputDetail'</span>,0);
0172 <a href="#_sub1" class="code" title="subfunction interpretResults(results)">interpretResults</a>(res);
0173 fprintf(<span class="string">' &gt; Checking DIAMOND:\t\t\t\t\t\t\t\t\t'</span>);
0174 res=runtests(<span class="string">'diamondTests.m'</span>,<span class="string">'OutputDetail'</span>,0);
0175 <a href="#_sub1" class="code" title="subfunction interpretResults(results)">interpretResults</a>(res);
0176 fprintf(<span class="string">' &gt; Checking HMMER:\t\t\t\t\t\t\t\t\t\t'</span>);
0177 res=runtests(<span class="string">'hmmerTests.m'</span>,<span class="string">'OutputDetail'</span>,0);
0178 <a href="#_sub1" class="code" title="subfunction interpretResults(results)">interpretResults</a>(res);
0179 
0180 <span class="keyword">if</span> develMode
0181     fprintf(<span class="string">'\n=== Development binary executables ===\n'</span>);
0182     fprintf(<span class="string">'NOTE: These binaries are only required when using KEGG FTP dump files in getKEGGModelForOrganism\n'</span>);
0183     fprintf(<span class="string">' &gt; Checking CD-HIT:\t\t\t\t\t\t\t\t\t\t'</span>);
0184     res=runtests(<span class="string">'cdhitTests.m'</span>,<span class="string">'OutputDetail'</span>,0);
0185     <a href="#_sub1" class="code" title="subfunction interpretResults(results)">interpretResults</a>(res);
0186     fprintf(<span class="string">' &gt; Checking MAFFT:\t\t\t\t\t\t\t\t\t\t'</span>);
0187     res=runtests(<span class="string">'mafftTests.m'</span>,<span class="string">'OutputDetail'</span>,0);
0188     <a href="#_sub1" class="code" title="subfunction interpretResults(results)">interpretResults</a>(res);
0189 <span class="keyword">end</span>
0190 
0191 fprintf(<span class="string">'\n=== Compatibility ===\n'</span>);
0192 fprintf(<span class="string">' &gt; Checking uniqueness of RAVEN functions:\t\t\t\t'</span>);
0193 <a href="checkFunctionUniqueness.html" class="code" title="function checkFunctionUniqueness()">checkFunctionUniqueness</a>();
0194 
0195 fprintf(<span class="string">'\n*** checkInstallation complete ***\n\n'</span>);
0196 <span class="keyword">end</span>
0197 
0198 <a name="_sub1" href="#_subfunctions" class="code">function interpretResults(results)</a>
0199 <span class="keyword">if</span> results.Failed==0 &amp;&amp; results.Incomplete==0
0200     fprintf(<span class="string">'Pass\n'</span>);
0201 <span class="keyword">else</span>
0202     fprintf(<span class="string">'Fail\n'</span>)
0203     fprintf(<span class="string">'   Download/compile the binary and rerun checkInstallation\n'</span>);
0204 <span class="keyword">end</span>
0205 <span class="keyword">end</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>