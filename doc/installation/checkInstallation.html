<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of checkInstallation</title>
  <meta name="keywords" content="checkInstallation">
  <meta name="description" content="checkInstallation">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">installation</a> &gt; checkInstallation.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for installation&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>checkInstallation
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>checkInstallation</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function checkInstallation(develMode) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> checkInstallation
   The purpose of this function is to check if all necessary functions are
   installed and working. It also checks whether there are any functions
   with overlapping names between RAVEN and other toolboxes or
   user-defined functions, which are accessible from MATLAB pathlist

   Input: 
   develMode       logical indicating development mode, which includes
                   testing of binaries that are required to update KEGG
                   HMMs (opt, default false)

   Usage: checkInstallation(develMode)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="checkFunctionUniqueness.html" class="code" title="function checkFunctionUniqueness()">checkFunctionUniqueness</a>	checkFunctionUniqueness</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function interpretResults(results)</a></li><li><a href="#_sub2" class="code">function str = myStr(InputStr,len)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function checkInstallation(develMode)</a>
0002 <span class="comment">% checkInstallation</span>
0003 <span class="comment">%   The purpose of this function is to check if all necessary functions are</span>
0004 <span class="comment">%   installed and working. It also checks whether there are any functions</span>
0005 <span class="comment">%   with overlapping names between RAVEN and other toolboxes or</span>
0006 <span class="comment">%   user-defined functions, which are accessible from MATLAB pathlist</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%   Input:</span>
0009 <span class="comment">%   develMode       logical indicating development mode, which includes</span>
0010 <span class="comment">%                   testing of binaries that are required to update KEGG</span>
0011 <span class="comment">%                   HMMs (opt, default false)</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%   Usage: checkInstallation(develMode)</span>
0014 
0015 <span class="keyword">if</span> nargin&lt;1
0016     develMode=false;
0017 <span class="keyword">end</span>
0018 
0019 <span class="comment">%Check if RAVEN is in the MATLAB path list</span>
0020 paths=textscan(path,<span class="string">'%s'</span>,<span class="string">'delimiter'</span>, pathsep);
0021 paths=paths{1};
0022 
0023 <span class="comment">%Get the RAVEN path</span>
0024 [ST, I]=dbstack(<span class="string">'-completenames'</span>);
0025 [ravenDir,~,~]=fileparts(fileparts(ST(I).file));
0026 
0027 fprintf(<span class="string">'\n*** THE RAVEN TOOLBOX ***\n\n'</span>);
0028 <span class="comment">%Print the RAVEN version if it is not the development version</span>
0029 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">' &gt; Checking RAVEN release:'</span>,40) <span class="string">'%f'</span>])
0030 <span class="keyword">if</span> exist(fullfile(ravenDir,<span class="string">'version.txt'</span>), <span class="string">'file'</span>) == 2
0031     fprintf([fgetl(fopen(fullfile(ravenDir,<span class="string">'version.txt'</span>))) <span class="string">'\n'</span>]);
0032     fclose(<span class="string">'all'</span>);
0033 <span class="keyword">else</span>
0034     fprintf(<span class="string">'DEVELOPMENT\n'</span>);
0035 <span class="keyword">end</span>
0036 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">' &gt; Checking MATLAB release:'</span>,40) <span class="string">'%f'</span>])
0037 fprintf([version(<span class="string">'-release'</span>) <span class="string">'\n'</span>])
0038 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">' &gt; Set RAVEN in MATLAB path:'</span>,40) <span class="string">'%f'</span>])
0039 subpath=regexp(genpath(ravenDir),pathsep,<span class="string">'split'</span>); <span class="comment">%List all subdirectories</span>
0040 pathsToKeep=cellfun(@(x) isempty(strfind(x,<span class="string">'.git'</span>)),subpath) &amp; cellfun(@(x) isempty(strfind(x,<span class="string">'doc'</span>)),subpath);
0041 addpath(strjoin(subpath(pathsToKeep),pathsep));
0042 savepath
0043 fprintf(<span class="string">'Pass\n'</span>);
0044 
0045 <span class="comment">%Check if it is possible to parse an Excel file</span>
0046 fprintf(<span class="string">'\n=== Model import and export ===\n'</span>);
0047 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">' &gt; Add Java paths for Excel format:'</span>,40) <span class="string">'%f'</span>])
0048 <span class="keyword">try</span>
0049     <span class="comment">%Add the required classes to the static Java path if not already added</span>
0050     addJavaPaths();
0051     fprintf(<span class="string">'Pass\n'</span>)
0052 <span class="keyword">catch</span>
0053     fprintf(<span class="string">'Fail\n'</span>)
0054 <span class="keyword">end</span>
0055 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">' &gt; Check libSBML version:'</span>,40) <span class="string">'%f'</span>])
0056 <span class="keyword">try</span>
0057     evalc(<span class="string">'importModel(fullfile(ravenDir,''tutorial'',''empty.xml''))'</span>);
0058     <span class="keyword">try</span>
0059         libSBMLver=OutputSBML; <span class="comment">% Only works in libSBML 5.17.0+</span>
0060         fprintf([libSBMLver.libSBML_version_string <span class="string">'\n'</span>]);
0061     <span class="keyword">catch</span>
0062         fprintf(<span class="string">'Fail\n'</span>)
0063         fprintf(<span class="string">'   An older libSBML version was found, update to version 5.17.0 or higher for a significant improvement of model import\n'</span>);
0064     <span class="keyword">end</span>
0065 <span class="keyword">catch</span>
0066     fprintf(<span class="string">'Fail\n'</span>)
0067     fprintf(<span class="string">'   Download libSBML from http://sbml.org/Software/libSBML/Downloading_libSBML and add to MATLAB path\n'</span>);
0068 <span class="keyword">end</span>
0069 fprintf(<span class="string">' &gt; Checking model import and export:\n'</span>)
0070 res=runtests(<span class="string">'importExportTests.m'</span>,<span class="string">'OutputDetail'</span>,0);
0071 
0072 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">'   &gt; Import Excel format:'</span>,40) <span class="string">'%f'</span>])
0073 <span class="keyword">if</span> res(1).Passed == 1
0074     fprintf(<span class="string">'Pass\n'</span>)
0075 <span class="keyword">else</span>
0076     fprintf(<span class="string">'Fail\n'</span>)
0077 <span class="keyword">end</span>
0078 
0079 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">'   &gt; Export Excel format:'</span>,40) <span class="string">'%f'</span>])
0080 <span class="keyword">if</span> res(3).Passed == 1
0081     fprintf(<span class="string">'Pass\n'</span>)
0082 <span class="keyword">else</span>
0083     fprintf(<span class="string">'Fail\n'</span>)
0084 <span class="keyword">end</span>
0085 
0086 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">'   &gt; Import SBML format:'</span>,40) <span class="string">'%f'</span>])
0087 <span class="keyword">if</span> res(2).Passed == 1
0088     fprintf(<span class="string">'Pass\n'</span>)
0089 <span class="keyword">else</span>
0090     fprintf(<span class="string">'Fail\n'</span>)
0091 <span class="keyword">end</span>
0092 
0093 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">'   &gt; Export SBML format:'</span>,40) <span class="string">'%f'</span>])
0094 <span class="keyword">if</span> res(4).Passed == 1
0095     fprintf(<span class="string">'Pass\n'</span>)
0096 <span class="keyword">else</span>
0097     fprintf(<span class="string">'Fail\n'</span>)
0098 <span class="keyword">end</span>
0099 
0100 <span class="keyword">if</span> res(1).Passed~=1 &amp;&amp; res(3).Passed~=1 &amp;&amp; exist(<span class="string">'vaderSentimentScores.m'</span>)==2
0101     fprintf([<span class="string">'   &gt; MATLAB Text Analytics Toolbox found. This should be\n'</span><span class="keyword">...</span>
0102              <span class="string">'     uninstalled if you want to read/write Excel files.\n'</span><span class="keyword">...</span>
0103              <span class="string">'     See RAVEN GitHub Issues page for instructions.\n'</span>])
0104 <span class="keyword">end</span>
0105 
0106 <span class="comment">%Check if it is possible to import an YAML model</span>
0107 <span class="comment">% fprintf(' &gt; Checking import of model in YAML format:\t\t\t');</span>
0108 <span class="comment">% try</span>
0109 <span class="comment">%     readYaml(ymlFile,true);</span>
0110 <span class="comment">%     fprintf('Pass\n');</span>
0111 <span class="comment">% catch</span>
0112 <span class="comment">%     fprintf('Fail\n');</span>
0113 <span class="comment">% end</span>
0114 
0115 fprintf(<span class="string">'\n=== Model solvers ===\n'</span>);
0116 
0117 <span class="comment">%Get current solver. Set it to 'none', if it is not set</span>
0118 fprintf(<span class="string">' &gt; Checking for functional LP solvers:\n'</span>)
0119 res=runtests(<span class="string">'solverTests.m'</span>,<span class="string">'OutputDetail'</span>,0);
0120 
0121 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">'   &gt; glpk:'</span>,40) <span class="string">'%f'</span>])
0122 <span class="keyword">if</span> res(1).Passed == 1
0123     fprintf(<span class="string">'Pass\n'</span>)
0124 <span class="keyword">else</span>
0125     fprintf(<span class="string">'Fail\n'</span>)
0126 <span class="keyword">end</span>
0127 
0128 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">'   &gt; gurobi:'</span>,40) <span class="string">'%f'</span>])
0129 <span class="keyword">if</span> res(2).Passed == 1
0130     fprintf(<span class="string">'Pass\n'</span>)
0131 <span class="keyword">else</span>
0132     fprintf(<span class="string">'Fail\n'</span>)
0133 <span class="keyword">end</span>
0134 
0135 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">'   &gt; cobra:'</span>,40) <span class="string">'%f'</span>])
0136 <span class="keyword">if</span> res(3).Passed == 1
0137     fprintf(<span class="string">'Pass\n'</span>)
0138 <span class="keyword">else</span>
0139     fprintf(<span class="string">'Fail\n'</span>)
0140 <span class="keyword">end</span>
0141 
0142 fprintf(<span class="string">' &gt; Checking for functional MILP solvers:\n'</span>)
0143 res=runtests(<span class="string">'fillGapsSmallTests.m'</span>,<span class="string">'OutputDetail'</span>,0);
0144 
0145 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">'   &gt; glpk:'</span>,40) <span class="string">'%f'</span>])
0146 <span class="keyword">if</span> res(1).Passed == 1
0147     fprintf(<span class="string">'Pass\n'</span>)
0148 <span class="keyword">else</span>
0149     fprintf(<span class="string">'Fail\n'</span>)
0150 <span class="keyword">end</span>
0151 
0152 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">'   &gt; gurobi:'</span>,40) <span class="string">'%f'</span>])
0153 <span class="keyword">if</span> res(2).Passed == 1
0154     fprintf(<span class="string">'Pass\n'</span>)
0155 <span class="keyword">else</span>
0156     fprintf(<span class="string">'Fail\n'</span>)
0157 <span class="keyword">end</span>
0158 
0159 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">'   &gt; cobra:'</span>,40) <span class="string">'%f'</span>])
0160 <span class="keyword">if</span> res(3).Passed == 1
0161     fprintf(<span class="string">'Pass\n'</span>)
0162 <span class="keyword">else</span>
0163     fprintf(<span class="string">'Fail\n'</span>)
0164 <span class="keyword">end</span>
0165 
0166 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">' &gt; Set RAVEN solver:'</span>,40) <span class="string">'%f'</span>])
0167 <span class="keyword">try</span>
0168     oldSolver=getpref(<span class="string">'RAVEN'</span>,<span class="string">'solver'</span>);
0169     solverIdx=find(strcmp(oldSolver,{<span class="string">'glpk'</span>,<span class="string">'gurobi'</span>,<span class="string">'cobra'</span>}));
0170 <span class="keyword">catch</span>
0171     solverIdx=0;
0172 <span class="keyword">end</span>
0173 <span class="comment">% Do not change old solver if functional</span>
0174 <span class="keyword">if</span> solverIdx~=0 &amp;&amp; res(solverIdx).Passed == 1
0175     fprintf([oldSolver <span class="string">'\n'</span>])
0176 <span class="comment">% Order of preference: gurobi &gt; glpk &gt; cobra</span>
0177 <span class="keyword">elseif</span> res(2).Passed == 1
0178     fprintf(<span class="string">'gurobi\n'</span>)
0179     setRavenSolver(<span class="string">'gurobi'</span>);
0180 <span class="keyword">elseif</span> res(1).Passed == 1
0181     fprintf(<span class="string">'glpk\n'</span>)
0182     setRavenSolver(<span class="string">'glpk'</span>);
0183 <span class="keyword">elseif</span> res(3).Passed == 1
0184     fprintf(<span class="string">'cobra\n'</span>)
0185     setRavenSolver(<span class="string">'cobra'</span>);
0186 <span class="keyword">else</span>
0187     fprintf(<span class="string">'None, no functional solvers\n'</span>)
0188     fprintf(<span class="string">'    The glpk should always be working, check your RAVEN installation to make sure all files are present\n'</span>)
0189 <span class="keyword">end</span>
0190 
0191 fprintf(<span class="string">'\n=== Essential binary executables ===\n'</span>);
0192 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">' &gt; Checking BLAST+:'</span>,40) <span class="string">'%f'</span>])
0193 res=runtests(<span class="string">'blastPlusTests.m'</span>,<span class="string">'OutputDetail'</span>,0);
0194 <a href="#_sub1" class="code" title="subfunction interpretResults(results)">interpretResults</a>(res);
0195 
0196 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">' &gt; Checking DIAMOND:'</span>,40) <span class="string">'%f'</span>])
0197 res=runtests(<span class="string">'diamondTests.m'</span>,<span class="string">'OutputDetail'</span>,0);
0198 <a href="#_sub1" class="code" title="subfunction interpretResults(results)">interpretResults</a>(res);
0199 
0200 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">' &gt; Checking HMMER:'</span>,40) <span class="string">'%f'</span>])
0201 res=runtests(<span class="string">'hmmerTests.m'</span>,<span class="string">'OutputDetail'</span>,0);
0202 <a href="#_sub1" class="code" title="subfunction interpretResults(results)">interpretResults</a>(res);
0203 
0204 <span class="keyword">if</span> develMode
0205     fprintf(<span class="string">'\n=== Development binary executables ===\n'</span>);
0206     fprintf(<span class="string">'NOTE: These binaries are only required when using KEGG FTP dump files in getKEGGModelForOrganism\n'</span>);
0207 
0208     fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">' &gt; Checking CD-HIT:'</span>,40) <span class="string">'%f'</span>])
0209     res=runtests(<span class="string">'cdhitTests.m'</span>,<span class="string">'OutputDetail'</span>,0);
0210     <a href="#_sub1" class="code" title="subfunction interpretResults(results)">interpretResults</a>(res);
0211 
0212     fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">' &gt; Checking MAFFT:'</span>,40) <span class="string">'%f'</span>])
0213     res=runtests(<span class="string">'mafftTests.m'</span>,<span class="string">'OutputDetail'</span>,0);
0214     <a href="#_sub1" class="code" title="subfunction interpretResults(results)">interpretResults</a>(res);
0215 <span class="keyword">end</span>
0216 
0217 fprintf(<span class="string">'\n=== Compatibility ===\n'</span>);
0218 fprintf([<a href="#_sub2" class="code" title="subfunction str = myStr(InputStr,len)">myStr</a>(<span class="string">' &gt; Checking function uniqueness:'</span>,40) <span class="string">'%f'</span>])
0219 <a href="checkFunctionUniqueness.html" class="code" title="function checkFunctionUniqueness()">checkFunctionUniqueness</a>();
0220 
0221 fprintf(<span class="string">'\n*** checkInstallation complete ***\n\n'</span>);
0222 <span class="keyword">end</span>
0223 
0224 <a name="_sub1" href="#_subfunctions" class="code">function interpretResults(results)</a>
0225 <span class="keyword">if</span> results.Failed==0 &amp;&amp; results.Incomplete==0
0226     fprintf(<span class="string">'Pass\n'</span>);
0227 <span class="keyword">else</span>
0228     fprintf(<span class="string">'Fail\n'</span>)
0229     fprintf(<span class="string">'   Download/compile the binary and rerun checkInstallation\n'</span>);
0230 <span class="keyword">end</span>
0231 <span class="keyword">end</span>
0232 
0233 <a name="_sub2" href="#_subfunctions" class="code">function str = myStr(InputStr,len)</a>
0234 str=InputStr;
0235 lenDiff = len - length(str);
0236 <span class="keyword">if</span> lenDiff &lt; 0
0237     warning(<span class="string">'String too long'</span>);
0238 <span class="keyword">else</span>
0239     str = [str blanks(lenDiff)];
0240 <span class="keyword">end</span>
0241 <span class="keyword">end</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>